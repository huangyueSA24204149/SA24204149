<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Huang Yue" />

<meta name="date" content="2024-12-07" />

<title>homework answer</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">homework answer</h1>
<h4 class="author">Huang Yue</h4>
<h4 class="date">2024-12-07</h4>



<p>A-SA24204149-2024-09-09</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="co">#Example 1</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>result<span class="ot">&lt;-</span><span class="fu">median</span>(x)<span class="co">#计算向量x的中位数</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>result</span></code></pre></div>
<pre><code>## [1] 5</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="co">#Example 2</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>matrix1<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>),<span class="at">ncol=</span><span class="dv">2</span>,<span class="at">nrow=</span><span class="dv">2</span>)</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>matrix2<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>),<span class="at">ncol=</span><span class="dv">2</span>,<span class="at">nrow=</span><span class="dv">2</span>)</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>output<span class="ot">&lt;-</span>matrix1<span class="sc">%*%</span>matrix2<span class="co">#计算两个矩阵的乘积</span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>output</span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]   23   31
## [2,]   34   46</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="co">#Example 3</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="fu">data</span>(ToothGrowth)<span class="co">#导入R自带的数据集（VC与牙齿成长的关系）</span></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(len <span class="sc">~</span> supp <span class="sc">*</span> dose, <span class="at">data =</span> ToothGrowth)<span class="co">#建立线性回归模型</span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a><span class="fu">summary</span>(model)<span class="co">#R方为0.7296拟合效果良好</span></span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = len ~ supp * dose, data = ToothGrowth)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -8.2264 -2.8462  0.0504  2.2893  7.9386 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   11.550      1.581   7.304 1.09e-09 ***
## suppVC        -8.255      2.236  -3.691 0.000507 ***
## dose           7.811      1.195   6.534 2.03e-08 ***
## suppVC:dose    3.904      1.691   2.309 0.024631 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 4.083 on 56 degrees of freedom
## Multiple R-squared:  0.7296, Adjusted R-squared:  0.7151 
## F-statistic: 50.36 on 3 and 56 DF,  p-value: 6.521e-16</code></pre>
<p>A-SA24204149-2024-09-19</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="co">#3.4</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="co">#首先由密度函数求出分布函数F,再由F计算出F^(-1)=sqrt(-2*σ^2*ln(1-U))</span></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">3</span>)</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">1000</span></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a>U<span class="ot">&lt;-</span><span class="fu">runif</span>(<span class="dv">1000</span>)</span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a>a<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a>b<span class="ot">=</span><span class="dv">2</span></span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a>c<span class="ot">=</span><span class="dv">3</span></span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a><span class="co">#σ=1</span></span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a>X1<span class="ot">&lt;-</span><span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>a<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>U))</span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a><span class="fu">hist</span>(X1,<span class="at">prob=</span><span class="cn">TRUE</span>)</span>
<span id="cb7-12"><a href="#cb7-12" tabindex="-1"></a>y1<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">6</span>, .<span class="dv">01</span>)</span>
<span id="cb7-13"><a href="#cb7-13" tabindex="-1"></a><span class="fu">lines</span>(y1,(y1<span class="sc">/</span>a<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>y1<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>a<span class="sc">^</span><span class="dv">2</span>)))</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="co">#σ=2</span></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>X2<span class="ot">&lt;-</span><span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>b<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>U))</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a><span class="fu">hist</span>(X2,<span class="at">prob=</span><span class="cn">TRUE</span>)</span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>y2<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">8</span>, .<span class="dv">01</span>)</span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a><span class="fu">lines</span>(y2,(y2<span class="sc">/</span>b<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>y2<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>b<span class="sc">^</span><span class="dv">2</span>)))</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="co">#σ=3</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>X3<span class="ot">&lt;-</span><span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>c<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>U))</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a><span class="fu">hist</span>(X3,<span class="at">prob=</span><span class="cn">TRUE</span>)</span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a>y3<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">12</span>, .<span class="dv">01</span>)</span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a><span class="fu">lines</span>(y3,(y3<span class="sc">/</span>c<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>y3<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>c<span class="sc">^</span><span class="dv">2</span>)))</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAulBMVEUAAAAAACsAAFUAKysAK1UAK4AAVYAAVaorAAArACsrAFUrKwArKysrK1UrK4ArVYArVaorgKorgNRVAABVACtVKwBVKytVVStVgIBVgKpVgNRVqtRVqv+AKwCAVQCAVSuAgFWAgKqAqoCAqtSAqv+A1P+qVQCqVSuqVYCqgFWqqoCq1NSq1P+q/6qq///T09PUgCvUgFXUqlXUqoDU1KrU1NTU/6rU////qlX/1ID/1Kr//6r//9T///+F0w9iAAAACXBIWXMAAA7DAAAOwwHHb6hkAAALFklEQVR4nO2daWPjthGG4e06VuLmqNTN0axytDW3aZw1s5vUlC39/79VHDxACcALgCAIyfN+sClKAolHgyGAGYLsQHKKLX0CpYsAAREgIAIERICACBAQAQIiQEAECIgAAREgIAIERICACBAQAQIiQEAECIgAAREgIAIERICACBAQAQIiQEAECIgAAREgIAIERICACBAQAQIiQEDzAdpv2fWj+n/Tv9De/s/71Ad8t2LsK7G1W7FX74f/Tz8ydvXdI/i6RUsBenrzKjWghnGt5WbN+DHFQdnbw+F5I94QO2KUCdCJKpYcUM2u7oZjczQKk/j3vfjzNqrUvBb0+y039i/vBR8ugejj14z9RZn//h1jr+8kOV7Xf75hr+4PH9/wz31+J83g5uMtu/r+8PuKf2o4TF+ALLJDJBrXf1UD2//yV35ovuMMANXS1sVpd4DaPeKD4lfnNbwddl8/NuptXu22nTB226FVGgoYAWr390z21fBWmGYF1KkFJKzg8fBBOgrVxPjvqritpQu5eeQVaQFd3x/+5N/6RP74awloLb6rmsu6PYheQK0zkEB7t9ewkdWFKCcgXpvXv7bvKkCtJ6qUUYltXjEFqPvx//jlVhTA9/Pqqr+SmF7MoWuXGoRGMydpT1/FVSMnILVHeRxZpa4Viqp126O67n/sChDWd2j/DoD0AsaA5LHWw9l8XOmvApTVBz29US7l3y0HVV/5a7/ttnVAopavf/5jYwWkFzAGVI880iH+spm5H/T0023nUj0sSJF4tgOyWhD/4NU3TO97nQkg8fqHwePYfZCsqzSM3kkbAFl9EPf1a2F//HNPX6/Wcs91VF86JyBe37/JdiYvPKI29qtYZ0HXj09buw+yXcUa1jpzvocfmv/9wM7BB73ruzVyXODqB/U+yOmk9X6QBkg0sDv1puLUfSRCeZvYB+GBPr8/tN3m+7Yj/A/1Bb7ri/uTq9jrf9V8lw2QVsAAqGpHXn0jK3KwGqlYXzGXygFUyb4ct47IYfdMKgdQO+6KHTPNpXIAietxO9YvSQUBKlMECIgAAREgIAIERICACBAQAQIiQEAECIgAAREgIAIERICACBAQAQIiQEAECIgAAREgIAIERICACBBQGKAumyB5Cm+5CgJUd0kDTWQuyRkqBNB+O2SdlJVhMKNCAD1v+rzj5sU0MrIgoEAf1JoQ+SCLuhsCXoz9UD8IKi8gpivrkaMVdpp1dwdNHZmV/TDoEgHV8r4keZMaATJIXeb3W5G6TYAM6jqK1fUjATKp7yhWNxMBnZGfDvNBLRZ1x4leiueliXV8lAWdA6LQq5hqZPutxYK8AEk+qomVTyjxCfoAYkzzQcUTyg+IsZGTLp1Q5OnZnDQGxNjRVaxwQrktqOczXObLJpQdkKEfRICGt5kJUNGEEkc1ICBjT7rkRpY4qhEHqGQTSjwn7deTPh2LlUsocVTDXRyzAyqWUFYLsgMq14QSRzWcxbExoPH0a6mEEkc13IDGPmhsTaU2soz9IOYEVKoJ5QR0cAMqk1A5gAo1oXyApJU4ARVJqCBAZZpQf1LdaleJijt9xwmo3Iirdjo1i12EyFic6R0rIO1fuYAOCRhNBMRKB6QQTcges9au9TJuQA+lA2pkboKMLQeWAh2IHyCxUSwgMYxQZCYkIF4woOdNipWNbLVjnoD4VrGA/q74TMtftQJq/10AoMi0hOPitF26IKCHQvtB1VCH1Jf5UTT1bAENFpSoOG3Xw/gyDgAV28RmK44AgeJG8XgfQGURUmfzvFn3i8Ynd9Ljbo4HoKIGrnksKAiQMX6/mOYPPV8MIN7M2vWFrYoKPY8q7AVIAzqhZok0nEIlHltwc6js02ZxgcNLASTiyg0fyzuGGnGh5xhAx1loC2oEqBJrXdsBRVoQCwb0UCIg3raeN+LpKY6Z6ajQ8yjlxRNQP8U4oWaJNJoPEg9vcM7cx4SeLwbQXMVFAer+pj27GOUZi0UAKiXCMZwC7ASGFTfsigJUTAhIc9IpboW/YECiIw3Uj2ftdpYOUCkhoFE/CMl6k89pccOeaEBlRDj6UwAXeM8PJQRUSAhoOIXG5ymJlg85JnAmACoiwqFnd8xxFfOKZJQcApq7H+TIS8SAXsKM4hRARUxPa6cgH0FZ+YXFvG+ouyBAzdVdLUbzSQOHrtRfn+0p55JG2mV+LWd50oaeXZmtPtvLExp1FAWgtMkLFwSos6DKNWsfHNWYDGhxQsc+qHZ1F4OjGmwqoOVTg8dXMffz4cLnpMXLiU56aUIhxw+PaqQAtDChkMMvYkFLm9DRWMyd3xoa1XBn1/sCWpZQd/SqXZvMnWAWGNWQryZ3FIsA1HTOebfymPSAxemvpvekFyWkDq5NhDli897FjV4lALQkoT6BqtuRcqiRCNCiJtQBSrTOLzt9kWKwuiChMwG0HKHCAS2fr1g4IG1rYUAwJBhS3Gg7EaBlLShxcaOWkQbQYlNDaQ575CiYXrtEgJZtYomLmwfQMoTmAxRwh0/Js4szAkoBRd9epjd0ToAWIXRWgJYgdF6AFiA0GyAGKxy6vcyw44wAdZw6a8qjswOUOzUv7FCekdVZAWXOPAs6lG9klY3H4YkB5e0yzhIXmxlQ1lHHLJHVuQHltKGztKCcw45AH+QXWc1hQbn6RGHFe0ZW2chhzAFIUVLbEwkAzdQPygHogeXoNJ4zIIWoKEDeHcVMgB6O3NEMsObpKMbdhhm5rQUGFgbkf5mfHcrRdgdpYUD+HcXcgB46SOkJXYYF9dvp/VGajuJxXKxozQiIntRLOhEBAooENC1R75w0iwUt64RNmlCXdFg8CrW9sdR+DxEgoMSDVVDopQPCg1VQ6IUD8hhqgEIvHJB3LuxLBUQWhISjGqDQSwfkO1h9uYBeoAgQEAECIkBABAiIAAERICACBESAgAgQEAECIkBABAgoPaDGsoyVnM+2zJIYF07brZjx2bjiQZ7+K7DsPnsPDu5WckBiHZnGQGi/5Ttr89OAG9P8ScP3mZ7RUIsDeBN63oi5T9fBgVIDUrOOhiVk1Lo7xoisXALUXNDp59VCNb5r1DQqAuM4OFJqQOBUTLZ1qK9/OAW0+9S83FwQoIattdlz48GRkgOS9bLO6ZsWzudfMfig5tVvG6PbCGti+qlErdqfGpD6lWy/lWkuW7QlA6BatA3jCui2q4DlhHoqYCLdoqyAGpObtCz/WV9ZTFHYwW7lXde+BOPBsXI2MeNPKL9gAiSLOF1SLdTfdqcSZz9ZnbR5hb26TVA5BqEqduqq3W34VC0gsLyfXdku8wfXKrEGC1Jh3FNTVL+A/ypH6pPOJWqdytZRdLoNU09a+CYtljt8NsIHBXz+WOmHGrX5ItM2JXPTMA41GsvooAoaNUhAzoO7RYNVIAIERICACBAQAQIiQEAECIgAAREgIAIERICACBAQAQIiQEAECIgAAREgIAIERICACBAQAQIiQEAECIgAAREgIAIERICAygW0W6mAvUzMsAT8M6hcQG3Kk0zMEPlGUSmY01UwIJnoIrMU5SMYjfmK86tkQCKNfMhVI0Cn2q2+HXIUa2pipxoyC5vIWy0mq2hA+622lNN+u8jqjUUDqq7/p93NssxlrGRA4oYDLb154mOoI1UwoN1K3rbC7SY09TelygW030ogz5v2VgVTSnAGFQuIO2jVouQ9FlXQXYYpVSygUkSAgAgQEAECIkBABAiIAAERICACBESAgAgQEAECIkBABAiIAAERICACBESAgAgQEAECIkBABAiIAAERIKD/A3DZUeF2nHiTAAAAAElFTkSuQmCC" /><!-- --></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="co">#由三个图我们可以看出这个算法生成的随机数满足原始分布</span></span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="co">#3.11</span></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="co"># 生成随机样本</span></span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">33</span>)</span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">1000</span></span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fl">0.75</span></span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> p1</span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n<span class="sc">*</span>p1, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a>n2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n<span class="sc">*</span>p2, <span class="at">mean =</span> <span class="dv">3</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a>mixture1<span class="ot">&lt;-</span> <span class="fu">c</span>(n1, n2)</span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a><span class="fu">hist</span>(mixture1,<span class="at">prob=</span><span class="cn">TRUE</span>)</span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a>y1<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">4</span>,<span class="dv">6</span>, .<span class="dv">01</span>)</span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a><span class="fu">lines</span>(y1,p1<span class="sc">*</span>(<span class="dv">1</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>y1<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>))<span class="sc">+</span>p2<span class="sc">*</span>(<span class="dv">1</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>(y1<span class="dv">-3</span>)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)))</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> p3</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>n3 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n<span class="sc">*</span>p3, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>n4 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n<span class="sc">*</span>p4, <span class="at">mean =</span> <span class="dv">3</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a>mixture2<span class="ot">&lt;-</span> <span class="fu">c</span>(n3, n4)</span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a><span class="fu">hist</span>(mixture2,<span class="at">prob=</span><span class="cn">TRUE</span>)</span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a>y2<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">4</span>,<span class="dv">6</span>, .<span class="dv">01</span>)</span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a><span class="fu">lines</span>(y2,p3<span class="sc">*</span>(<span class="dv">1</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>y2<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>))<span class="sc">+</span>p4<span class="sc">*</span>(<span class="dv">1</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>(y2<span class="dv">-3</span>)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)))</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="co">#由图可以看出密度曲线呈双峰分布，我们可以看到两峰的均值为两个分布的均值，而且哪个p大些对应的峰就高些，当p1=0.5时两峰一样高</span></span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="co">#3.20</span></span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2</span>)</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a>lambda <span class="ot">&lt;-</span><span class="dv">3</span>  <span class="co"># 泊松过程的平均发生率</span></span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a>shape<span class="ot">&lt;-</span><span class="dv">2</span></span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a>scale<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span>  <span class="co"># 模拟次数</span></span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="dv">10</span>      <span class="co"># 时间长度</span></span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a>simulation<span class="ot">&lt;-</span><span class="cf">function</span>(lambda,shape,scale,t){</span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a>  N<span class="ot">&lt;-</span><span class="fu">rpois</span>(<span class="dv">1</span>,lambda<span class="sc">*</span>t)</span>
<span id="cb14-10"><a href="#cb14-10" tabindex="-1"></a>  Y<span class="ot">&lt;-</span><span class="fu">rgamma</span>(N,<span class="at">shape=</span>shape,<span class="at">scale=</span>scale)</span>
<span id="cb14-11"><a href="#cb14-11" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">sum</span>(Y))</span>
<span id="cb14-12"><a href="#cb14-12" tabindex="-1"></a>}</span>
<span id="cb14-13"><a href="#cb14-13" tabindex="-1"></a>results<span class="ot">&lt;-</span><span class="fu">c</span>()</span>
<span id="cb14-14"><a href="#cb14-14" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb14-15"><a href="#cb14-15" tabindex="-1"></a>  results[i]<span class="ot">&lt;-</span><span class="fu">simulation</span>(lambda,shape,scale,t)</span>
<span id="cb14-16"><a href="#cb14-16" tabindex="-1"></a>}</span>
<span id="cb14-17"><a href="#cb14-17" tabindex="-1"></a>mean<span class="ot">&lt;-</span><span class="fu">mean</span>(results)</span>
<span id="cb14-18"><a href="#cb14-18" tabindex="-1"></a>var<span class="ot">&lt;-</span><span class="fu">var</span>(results)</span>
<span id="cb14-19"><a href="#cb14-19" tabindex="-1"></a>mean<span class="co">#估计值</span></span></code></pre></div>
<pre><code>## [1] 60.15682</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a>var<span class="co">#估计值</span></span></code></pre></div>
<pre><code>## [1] 182.6114</code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a>mean1 <span class="ot">&lt;-</span> lambda <span class="sc">*</span> t <span class="sc">*</span> (shape<span class="sc">/</span> scale)</span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a>var1 <span class="ot">&lt;-</span> lambda <span class="sc">*</span> t <span class="sc">*</span> (shape <span class="sc">*</span>(shape<span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span>scale<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a>mean1<span class="co">#理论值</span></span></code></pre></div>
<pre><code>## [1] 60</code></pre>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a>var1<span class="co">#理论值</span></span></code></pre></div>
<pre><code>## [1] 180</code></pre>
<p>A-SA24204149-2024-09-23</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a><span class="do">##5.4</span></span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2</span>)</span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" tabindex="-1"></a>monte_carlo_beta <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">n =</span> <span class="dv">100000</span>) {</span>
<span id="cb22-5"><a href="#cb22-5" tabindex="-1"></a>  samples <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(n, <span class="dv">3</span>,<span class="dv">3</span>)</span>
<span id="cb22-6"><a href="#cb22-6" tabindex="-1"></a>  c <span class="ot">&lt;-</span> <span class="fu">sum</span>(samples <span class="sc">&lt;=</span> x)</span>
<span id="cb22-7"><a href="#cb22-7" tabindex="-1"></a>  <span class="fu">return</span>(c<span class="sc">/</span>n)</span>
<span id="cb22-8"><a href="#cb22-8" tabindex="-1"></a>}</span>
<span id="cb22-9"><a href="#cb22-9" tabindex="-1"></a>estimated <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>, <span class="at">by =</span> <span class="fl">0.1</span>), monte_carlo_beta)<span class="do">##返回结果向量</span></span>
<span id="cb22-10"><a href="#cb22-10" tabindex="-1"></a>true<span class="ot">&lt;-</span> <span class="fu">pbeta</span>(<span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>, <span class="at">by =</span> <span class="fl">0.1</span>), <span class="dv">3</span>, <span class="dv">3</span>)</span>
<span id="cb22-11"><a href="#cb22-11" tabindex="-1"></a><span class="co"># 输出估计值和实际值进行比较</span></span>
<span id="cb22-12"><a href="#cb22-12" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">Estimated =</span> estimated, <span class="at">Actual =</span> true)</span></code></pre></div>
<pre><code>##   Estimated  Actual
## 1   0.00898 0.00856
## 2   0.05705 0.05792
## 3   0.16286 0.16308
## 4   0.31788 0.31744
## 5   0.50115 0.50000
## 6   0.68132 0.68256
## 7   0.83736 0.83692
## 8   0.94176 0.94208
## 9   0.99118 0.99144</code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a><span class="do">##5.9</span></span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb24-3"><a href="#cb24-3" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb24-4"><a href="#cb24-4" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb24-5"><a href="#cb24-5" tabindex="-1"></a>antithetic <span class="ot">&lt;-</span> <span class="cf">function</span>(s, n) {</span>
<span id="cb24-6"><a href="#cb24-6" tabindex="-1"></a>  a <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb24-7"><a href="#cb24-7" tabindex="-1"></a>  X <span class="ot">&lt;-</span> s <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">log</span>(a))</span>
<span id="cb24-8"><a href="#cb24-8" tabindex="-1"></a>  X_ <span class="ot">&lt;-</span> s <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">log</span>(<span class="dv">1</span> <span class="sc">-</span> a))</span>
<span id="cb24-9"><a href="#cb24-9" tabindex="-1"></a>  <span class="fu">return</span>((X <span class="sc">+</span> X_) <span class="sc">/</span> <span class="dv">2</span>)</span>
<span id="cb24-10"><a href="#cb24-10" tabindex="-1"></a>}</span>
<span id="cb24-11"><a href="#cb24-11" tabindex="-1"></a>Sample_antithetic <span class="ot">&lt;-</span> <span class="fu">antithetic</span>(s, n)</span>
<span id="cb24-12"><a href="#cb24-12" tabindex="-1"></a>var_antithetic <span class="ot">&lt;-</span> <span class="fu">var</span>(Sample_antithetic)</span>
<span id="cb24-13"><a href="#cb24-13" tabindex="-1"></a>rayleigh <span class="ot">&lt;-</span> <span class="cf">function</span>(s, n) {</span>
<span id="cb24-14"><a href="#cb24-14" tabindex="-1"></a>  U <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb24-15"><a href="#cb24-15" tabindex="-1"></a>  <span class="fu">return</span>(s <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">log</span>(U)))</span>
<span id="cb24-16"><a href="#cb24-16" tabindex="-1"></a>}</span>
<span id="cb24-17"><a href="#cb24-17" tabindex="-1"></a><span class="co"># 独立采样</span></span>
<span id="cb24-18"><a href="#cb24-18" tabindex="-1"></a>X_1 <span class="ot">&lt;-</span> <span class="fu">rayleigh</span>(s, n)</span>
<span id="cb24-19"><a href="#cb24-19" tabindex="-1"></a>X_2 <span class="ot">&lt;-</span> <span class="fu">rayleigh</span>(s, n)</span>
<span id="cb24-20"><a href="#cb24-20" tabindex="-1"></a>Sample <span class="ot">&lt;-</span> (X_1 <span class="sc">+</span> X_2) <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb24-21"><a href="#cb24-21" tabindex="-1"></a>var_independent <span class="ot">&lt;-</span> <span class="fu">var</span>(Sample)</span>
<span id="cb24-22"><a href="#cb24-22" tabindex="-1"></a>reduced <span class="ot">&lt;-</span> (var_independent <span class="sc">-</span> var_antithetic) <span class="sc">/</span> var_independent <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb24-23"><a href="#cb24-23" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;独立采样的样本方差为&quot;</span>, var_independent, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 独立采样的样本方差为 0.2161879</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;对偶变量法采样的样本方差为&quot;</span>, var_antithetic, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 对偶变量法采样的样本方差为 0.01141726</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;方差减少的百分比为：&quot;</span>, reduced, <span class="st">&quot;%</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 方差减少的百分比为： 94.71883 %</code></pre>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a><span class="do">##5.13</span></span>
<span id="cb30-2"><a href="#cb30-2" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb30-3"><a href="#cb30-3" tabindex="-1"></a>  <span class="fu">ifelse</span>(x <span class="sc">&gt;</span> <span class="dv">1</span>, x <span class="sc">^</span> <span class="dv">2</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">2</span> <span class="sc">*</span> pi) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>x <span class="sc">^</span> <span class="dv">2</span> <span class="sc">/</span> <span class="dv">2</span>), <span class="dv">0</span>)</span>
<span id="cb30-4"><a href="#cb30-4" tabindex="-1"></a>}</span>
<span id="cb30-5"><a href="#cb30-5" tabindex="-1"></a>f1 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb30-6"><a href="#cb30-6" tabindex="-1"></a>  <span class="fu">ifelse</span>(x <span class="sc">&gt;</span> <span class="dv">1</span>, <span class="fu">exp</span>(<span class="sc">-</span>(x <span class="sc">-</span> <span class="dv">1</span>)), <span class="dv">0</span>)</span>
<span id="cb30-7"><a href="#cb30-7" tabindex="-1"></a>}</span>
<span id="cb30-8"><a href="#cb30-8" tabindex="-1"></a>f2 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb30-9"><a href="#cb30-9" tabindex="-1"></a>  <span class="fu">ifelse</span>(x <span class="sc">&gt;</span> <span class="dv">1</span>, <span class="dv">2</span> <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> (x <span class="sc">-</span> <span class="dv">1</span>)), <span class="dv">0</span>)</span>
<span id="cb30-10"><a href="#cb30-10" tabindex="-1"></a>}</span>
<span id="cb30-11"><a href="#cb30-11" tabindex="-1"></a></span>
<span id="cb30-12"><a href="#cb30-12" tabindex="-1"></a></span>
<span id="cb30-13"><a href="#cb30-13" tabindex="-1"></a><span class="co"># 生成数据</span></span>
<span id="cb30-14"><a href="#cb30-14" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb30-15"><a href="#cb30-15" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">1.01</span>, <span class="dv">5</span>, <span class="at">by =</span> <span class="fl">0.1</span>)</span>
<span id="cb30-16"><a href="#cb30-16" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb30-17"><a href="#cb30-17" tabindex="-1"></a>  <span class="at">x =</span> x,</span>
<span id="cb30-18"><a href="#cb30-18" tabindex="-1"></a>  <span class="at">g =</span> <span class="fu">g</span>(x),</span>
<span id="cb30-19"><a href="#cb30-19" tabindex="-1"></a>  <span class="at">f1 =</span> <span class="fu">f1</span>(x),</span>
<span id="cb30-20"><a href="#cb30-20" tabindex="-1"></a>  <span class="at">f2 =</span> <span class="fu">f2</span>(x)</span>
<span id="cb30-21"><a href="#cb30-21" tabindex="-1"></a>)</span>
<span id="cb30-22"><a href="#cb30-22" tabindex="-1"></a></span>
<span id="cb30-23"><a href="#cb30-23" tabindex="-1"></a><span class="co"># 绘制图像</span></span>
<span id="cb30-24"><a href="#cb30-24" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> x)) <span class="sc">+</span></span>
<span id="cb30-25"><a href="#cb30-25" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> g, <span class="at">color =</span> <span class="st">&quot;g(x)&quot;</span>)) <span class="sc">+</span></span>
<span id="cb30-26"><a href="#cb30-26" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> f1, <span class="at">color =</span> <span class="st">&quot;f1&quot;</span>)) <span class="sc">+</span></span>
<span id="cb30-27"><a href="#cb30-27" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> f2, <span class="at">color =</span> <span class="st">&quot;f2&quot;</span>)) <span class="sc">+</span></span>
<span id="cb30-28"><a href="#cb30-28" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;x&quot;</span>, <span class="at">y =</span> <span class="st">&quot;函数值&quot;</span>, <span class="at">color =</span> <span class="st">&quot;函数&quot;</span>) <span class="sc">+</span></span>
<span id="cb30-29"><a href="#cb30-29" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(</span>
<span id="cb30-30"><a href="#cb30-30" tabindex="-1"></a>    <span class="st">&quot;g(x)&quot;</span> <span class="ot">=</span> <span class="st">&quot;green&quot;</span>,</span>
<span id="cb30-31"><a href="#cb30-31" tabindex="-1"></a>    <span class="st">&quot;f1&quot;</span> <span class="ot">=</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb30-32"><a href="#cb30-32" tabindex="-1"></a>    <span class="st">&quot;f2&quot;</span> <span class="ot">=</span> <span class="st">&quot;blue&quot;</span></span>
<span id="cb30-33"><a href="#cb30-33" tabindex="-1"></a>  ))<span class="sc">+</span></span>
<span id="cb30-34"><a href="#cb30-34" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme</span>(<span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="dv">02</span>, <span class="st">&quot;cm&quot;</span>)))</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb31-2"><a href="#cb31-2" tabindex="-1"></a>samples1 <span class="ot">&lt;-</span> <span class="fu">rexp</span>(m, <span class="dv">1</span>) <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb31-3"><a href="#cb31-3" tabindex="-1"></a>gf1 <span class="ot">&lt;-</span> <span class="fu">g</span>(samples1) <span class="sc">/</span> <span class="fu">f1</span>(samples1)</span>
<span id="cb31-4"><a href="#cb31-4" tabindex="-1"></a>var1 <span class="ot">&lt;-</span> <span class="fu">var</span>(gf1)</span>
<span id="cb31-5"><a href="#cb31-5" tabindex="-1"></a>samples2 <span class="ot">&lt;-</span> <span class="fu">rexp</span>(m, <span class="dv">2</span>) <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb31-6"><a href="#cb31-6" tabindex="-1"></a>gf2 <span class="ot">&lt;-</span> <span class="fu">g</span>(samples2) <span class="sc">/</span> <span class="fu">f1</span>(samples2)</span>
<span id="cb31-7"><a href="#cb31-7" tabindex="-1"></a>var2 <span class="ot">&lt;-</span> <span class="fu">var</span>(gf2)</span>
<span id="cb31-8"><a href="#cb31-8" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;f1产生的方差为：&quot;</span>, var1, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## f1产生的方差为： 0.02530364</code></pre>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;f2产生的方差为：&quot;</span>, var2, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## f2产生的方差为： 0.0138713</code></pre>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" tabindex="-1"></a><span class="do">##f2产生的方差更小</span></span></code></pre></div>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" tabindex="-1"></a><span class="do">##question</span></span>
<span id="cb36-2"><a href="#cb36-2" tabindex="-1"></a><span class="do">##定义排序函数</span></span>
<span id="cb36-3"><a href="#cb36-3" tabindex="-1"></a>sort <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb36-4"><a href="#cb36-4" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(x) <span class="sc">&lt;=</span> <span class="dv">1</span>)</span>
<span id="cb36-5"><a href="#cb36-5" tabindex="-1"></a>    <span class="fu">return</span>(x)</span>
<span id="cb36-6"><a href="#cb36-6" tabindex="-1"></a>  a <span class="ot">&lt;-</span> x[<span class="fu">sample</span>(<span class="fu">length</span>(x), <span class="dv">1</span>)]</span>
<span id="cb36-7"><a href="#cb36-7" tabindex="-1"></a>  left <span class="ot">&lt;-</span> x[x <span class="sc">&lt;</span> a]</span>
<span id="cb36-8"><a href="#cb36-8" tabindex="-1"></a>  right <span class="ot">&lt;-</span> x[x <span class="sc">&gt;</span> a]</span>
<span id="cb36-9"><a href="#cb36-9" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">c</span>(<span class="fu">sort</span>(left), a, <span class="fu">sort</span>(right)))</span>
<span id="cb36-10"><a href="#cb36-10" tabindex="-1"></a>}</span>
<span id="cb36-11"><a href="#cb36-11" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb36-12"><a href="#cb36-12" tabindex="-1"></a>values <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span> <span class="sc">*</span> <span class="dv">10</span> <span class="sc">^</span> <span class="dv">4</span>, <span class="dv">2</span> <span class="sc">*</span> <span class="dv">10</span> <span class="sc">^</span> <span class="dv">4</span>, <span class="dv">4</span> <span class="sc">*</span> <span class="dv">10</span> <span class="sc">^</span> <span class="dv">4</span>, <span class="dv">6</span> <span class="sc">*</span> <span class="dv">10</span> <span class="sc">^</span> <span class="dv">4</span>, <span class="dv">8</span> <span class="sc">*</span> <span class="dv">10</span> <span class="sc">^</span> <span class="dv">4</span>)</span>
<span id="cb36-13"><a href="#cb36-13" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">100</span> </span>
<span id="cb36-14"><a href="#cb36-14" tabindex="-1"></a>times <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(values))</span>
<span id="cb36-15"><a href="#cb36-15" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(values)) {</span>
<span id="cb36-16"><a href="#cb36-16" tabindex="-1"></a>  n <span class="ot">&lt;-</span> values[i]</span>
<span id="cb36-17"><a href="#cb36-17" tabindex="-1"></a>  total <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb36-18"><a href="#cb36-18" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb36-19"><a href="#cb36-19" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>n</span>
<span id="cb36-20"><a href="#cb36-20" tabindex="-1"></a>    start <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb36-21"><a href="#cb36-21" tabindex="-1"></a>    <span class="fu">sort</span>(x)</span>
<span id="cb36-22"><a href="#cb36-22" tabindex="-1"></a>    end <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb36-23"><a href="#cb36-23" tabindex="-1"></a>    total <span class="ot">&lt;-</span> total <span class="sc">+</span> <span class="fu">as.numeric</span>(<span class="fu">difftime</span>(end, start, <span class="at">units =</span> <span class="st">&quot;secs&quot;</span>))</span>
<span id="cb36-24"><a href="#cb36-24" tabindex="-1"></a>  }</span>
<span id="cb36-25"><a href="#cb36-25" tabindex="-1"></a>  times[i] <span class="ot">&lt;-</span> total <span class="sc">/</span> m</span>
<span id="cb36-26"><a href="#cb36-26" tabindex="-1"></a>}</span>
<span id="cb36-27"><a href="#cb36-27" tabindex="-1"></a>t <span class="ot">&lt;-</span> values <span class="sc">*</span> <span class="fu">log</span>(values)</span>
<span id="cb36-28"><a href="#cb36-28" tabindex="-1"></a>time <span class="ot">&lt;-</span> <span class="fu">lm</span>(times <span class="sc">~</span> values)</span>
<span id="cb36-29"><a href="#cb36-29" tabindex="-1"></a><span class="fu">summary</span>(time)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = times ~ values)
## 
## Residuals:
##          1          2          3          4          5 
##  0.0005769 -0.0042116 -0.0004048  0.0114252 -0.0073857 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 5.512e-03  7.071e-03    0.78    0.493    
## values      6.093e-06  1.437e-07   42.39 2.89e-05 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.008232 on 3 degrees of freedom
## Multiple R-squared:  0.9983, Adjusted R-squared:  0.9978 
## F-statistic:  1797 on 1 and 3 DF,  p-value: 2.889e-05</code></pre>
<p>A-SA24204149-2024-09-30</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb38-2"><a href="#cb38-2" tabindex="-1"></a>skewness <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb38-3"><a href="#cb38-3" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb38-4"><a href="#cb38-4" tabindex="-1"></a>  mean_x <span class="ot">&lt;-</span> <span class="fu">mean</span>(x)</span>
<span id="cb38-5"><a href="#cb38-5" tabindex="-1"></a>  std_dev <span class="ot">&lt;-</span> <span class="fu">sd</span>(x)</span>
<span id="cb38-6"><a href="#cb38-6" tabindex="-1"></a>  m3 <span class="ot">&lt;-</span> <span class="fu">sum</span>((x <span class="sc">-</span> mean_x) <span class="sc">^</span> <span class="dv">3</span>) <span class="sc">/</span> n</span>
<span id="cb38-7"><a href="#cb38-7" tabindex="-1"></a>  <span class="fu">return</span>(m3 <span class="sc">/</span> std_dev <span class="sc">^</span> <span class="dv">3</span>)</span>
<span id="cb38-8"><a href="#cb38-8" tabindex="-1"></a>}</span>
<span id="cb38-9"><a href="#cb38-9" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb38-10"><a href="#cb38-10" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fl">1e4</span></span>
<span id="cb38-11"><a href="#cb38-11" tabindex="-1"></a></span>
<span id="cb38-12"><a href="#cb38-12" tabindex="-1"></a>skewness_values <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb38-13"><a href="#cb38-13" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb38-14"><a href="#cb38-14" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb38-15"><a href="#cb38-15" tabindex="-1"></a>  skewness_values[i] <span class="ot">&lt;-</span> <span class="fu">skewness</span>(x)</span>
<span id="cb38-16"><a href="#cb38-16" tabindex="-1"></a>}</span>
<span id="cb38-17"><a href="#cb38-17" tabindex="-1"></a></span>
<span id="cb38-18"><a href="#cb38-18" tabindex="-1"></a><span class="co"># 计算分位数和标准误差</span></span>
<span id="cb38-19"><a href="#cb38-19" tabindex="-1"></a>quantiles <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.05</span>, <span class="fl">0.95</span>, <span class="fl">0.975</span>)</span>
<span id="cb38-20"><a href="#cb38-20" tabindex="-1"></a>estimated_quantiles <span class="ot">&lt;-</span> <span class="fu">quantile</span>(skewness_values, quantiles)</span>
<span id="cb38-21"><a href="#cb38-21" tabindex="-1"></a></span>
<span id="cb38-22"><a href="#cb38-22" tabindex="-1"></a>density <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(estimated_quantiles)</span>
<span id="cb38-23"><a href="#cb38-23" tabindex="-1"></a>var <span class="ot">&lt;-</span> quantiles <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> quantiles) <span class="sc">/</span> (n <span class="sc">*</span> density <span class="sc">^</span> <span class="dv">2</span>)</span>
<span id="cb38-24"><a href="#cb38-24" tabindex="-1"></a>se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(var)</span>
<span id="cb38-25"><a href="#cb38-25" tabindex="-1"></a>large_sample_quantiles <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(quantiles, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="fu">sqrt</span>(<span class="dv">6</span> <span class="sc">/</span> n))</span>
<span id="cb38-26"><a href="#cb38-26" tabindex="-1"></a><span class="fu">print</span>(quantiles)<span class="co">#分位数</span></span></code></pre></div>
<pre><code>## [1] 0.025 0.050 0.950 0.975</code></pre>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" tabindex="-1"></a><span class="fu">print</span>(se)<span class="co">#标准差</span></span></code></pre></div>
<pre><code>##       2.5%         5%        95%      97.5% 
## 0.01251513 0.01741288 0.01741282 0.01252137</code></pre>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" tabindex="-1"></a><span class="fu">print</span>(estimated_quantiles)<span class="co">#估计分位数</span></span></code></pre></div>
<pre><code>##       2.5%         5%        95%      97.5% 
## -0.1498065 -0.1257532  0.1257233  0.1530960</code></pre>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" tabindex="-1"></a><span class="fu">print</span>(large_sample_quantiles)<span class="co">#大样本分位数</span></span></code></pre></div>
<pre><code>## [1] -0.1518182 -0.1274098  0.1274098  0.1518182</code></pre>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" tabindex="-1"></a>bivariate_normal <span class="ot">&lt;-</span> <span class="cf">function</span>(n, m) {</span>
<span id="cb46-2"><a href="#cb46-2" tabindex="-1"></a>  p_Pearson <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, m)</span>
<span id="cb46-3"><a href="#cb46-3" tabindex="-1"></a>  p_spearman <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, m)</span>
<span id="cb46-4"><a href="#cb46-4" tabindex="-1"></a>  p_kendall <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, m)</span>
<span id="cb46-5"><a href="#cb46-5" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb46-6"><a href="#cb46-6" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb46-7"><a href="#cb46-7" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb46-8"><a href="#cb46-8" tabindex="-1"></a>    cor <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(x, y)</span>
<span id="cb46-9"><a href="#cb46-9" tabindex="-1"></a>    p_Pearson[i] <span class="ot">&lt;-</span> cor<span class="sc">$</span>p.value</span>
<span id="cb46-10"><a href="#cb46-10" tabindex="-1"></a>    spearman<span class="ot">&lt;-</span> <span class="fu">cor.test</span>(x, y, <span class="at">method =</span> <span class="st">&#39;spearman&#39;</span>)</span>
<span id="cb46-11"><a href="#cb46-11" tabindex="-1"></a>    p_spearman[i] <span class="ot">&lt;-</span> spearman<span class="sc">$</span>p.value</span>
<span id="cb46-12"><a href="#cb46-12" tabindex="-1"></a>    kendall <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(x, y, <span class="at">method =</span> <span class="st">&#39;kendall&#39;</span>)</span>
<span id="cb46-13"><a href="#cb46-13" tabindex="-1"></a>    p_kendall[i] <span class="ot">&lt;-</span> kendall<span class="sc">$</span>p.value</span>
<span id="cb46-14"><a href="#cb46-14" tabindex="-1"></a>  }</span>
<span id="cb46-15"><a href="#cb46-15" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb46-16"><a href="#cb46-16" tabindex="-1"></a>    <span class="at">p_Pearson =</span> p_Pearson,</span>
<span id="cb46-17"><a href="#cb46-17" tabindex="-1"></a>    <span class="at">p_spearman =</span> p_spearman,</span>
<span id="cb46-18"><a href="#cb46-18" tabindex="-1"></a>    <span class="at">p_kendall =</span> p_kendall</span>
<span id="cb46-19"><a href="#cb46-19" tabindex="-1"></a>  )</span>
<span id="cb46-20"><a href="#cb46-20" tabindex="-1"></a>}</span>
<span id="cb46-21"><a href="#cb46-21" tabindex="-1"></a><span class="do">##功效函数</span></span>
<span id="cb46-22"><a href="#cb46-22" tabindex="-1"></a>compute_power <span class="ot">&lt;-</span> <span class="cf">function</span>(p_values) {</span>
<span id="cb46-23"><a href="#cb46-23" tabindex="-1"></a>  <span class="fu">mean</span>(p_values <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span>
<span id="cb46-24"><a href="#cb46-24" tabindex="-1"></a>}</span>
<span id="cb46-25"><a href="#cb46-25" tabindex="-1"></a></span>
<span id="cb46-26"><a href="#cb46-26" tabindex="-1"></a>power_bivariate_normal <span class="ot">&lt;-</span> <span class="cf">function</span>(n, m) {</span>
<span id="cb46-27"><a href="#cb46-27" tabindex="-1"></a> results <span class="ot">&lt;-</span> <span class="fu">bivariate_normal</span>(n, m)</span>
<span id="cb46-28"><a href="#cb46-28" tabindex="-1"></a>  power_Pearson <span class="ot">&lt;-</span> <span class="fu">compute_power</span>(results<span class="sc">$</span>p_Pearson)</span>
<span id="cb46-29"><a href="#cb46-29" tabindex="-1"></a>  power_spearman <span class="ot">&lt;-</span> <span class="fu">compute_power</span>(results<span class="sc">$</span>p_spearman)</span>
<span id="cb46-30"><a href="#cb46-30" tabindex="-1"></a>  power_kendall <span class="ot">&lt;-</span> <span class="fu">compute_power</span>(results<span class="sc">$</span>p_kendall)</span>
<span id="cb46-31"><a href="#cb46-31" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&#39;Pearson相关检验的功效：&#39;</span>, power_Pearson, <span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb46-32"><a href="#cb46-32" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&#39;Spearman检验的功效：&#39;</span>, power_spearman, <span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb46-33"><a href="#cb46-33" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&#39;Kendall检验的功效：&#39;</span>, power_kendall, <span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb46-34"><a href="#cb46-34" tabindex="-1"></a>}</span>
<span id="cb46-35"><a href="#cb46-35" tabindex="-1"></a></span>
<span id="cb46-36"><a href="#cb46-36" tabindex="-1"></a><span class="co"># 生成指数分布的数据并进行检验</span></span>
<span id="cb46-37"><a href="#cb46-37" tabindex="-1"></a>exponential <span class="ot">&lt;-</span> <span class="cf">function</span>(n, m) {</span>
<span id="cb46-38"><a href="#cb46-38" tabindex="-1"></a>  p_Pearson <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, m)</span>
<span id="cb46-39"><a href="#cb46-39" tabindex="-1"></a>  p_spearman <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, m)</span>
<span id="cb46-40"><a href="#cb46-40" tabindex="-1"></a>  p_kendall <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, m)</span>
<span id="cb46-41"><a href="#cb46-41" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb46-42"><a href="#cb46-42" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">rexp</span>(n)</span>
<span id="cb46-43"><a href="#cb46-43" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">rexp</span>(n)</span>
<span id="cb46-44"><a href="#cb46-44" tabindex="-1"></a>    cor<span class="ot">&lt;-</span> <span class="fu">cor.test</span>(x, y)</span>
<span id="cb46-45"><a href="#cb46-45" tabindex="-1"></a>    p_Pearson[i] <span class="ot">&lt;-</span> cor<span class="sc">$</span>p.value</span>
<span id="cb46-46"><a href="#cb46-46" tabindex="-1"></a>    spearman<span class="ot">&lt;-</span> <span class="fu">cor.test</span>(x, y, <span class="at">method =</span> <span class="st">&#39;spearman&#39;</span>)</span>
<span id="cb46-47"><a href="#cb46-47" tabindex="-1"></a>    p_spearman[i] <span class="ot">&lt;-</span> spearman<span class="sc">$</span>p.value</span>
<span id="cb46-48"><a href="#cb46-48" tabindex="-1"></a>    kendall<span class="ot">&lt;-</span> <span class="fu">cor.test</span>(x, y, <span class="at">method =</span> <span class="st">&#39;kendall&#39;</span>)</span>
<span id="cb46-49"><a href="#cb46-49" tabindex="-1"></a>    p_kendall[i] <span class="ot">&lt;-</span> kendall<span class="sc">$</span>p.value</span>
<span id="cb46-50"><a href="#cb46-50" tabindex="-1"></a>  }</span>
<span id="cb46-51"><a href="#cb46-51" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb46-52"><a href="#cb46-52" tabindex="-1"></a>    <span class="at">p_Pearson =</span> p_Pearson,</span>
<span id="cb46-53"><a href="#cb46-53" tabindex="-1"></a>    <span class="at">p_spearman =</span> p_spearman,</span>
<span id="cb46-54"><a href="#cb46-54" tabindex="-1"></a>    <span class="at">p_kendall =</span> p_kendall</span>
<span id="cb46-55"><a href="#cb46-55" tabindex="-1"></a>  )</span>
<span id="cb46-56"><a href="#cb46-56" tabindex="-1"></a>}</span>
<span id="cb46-57"><a href="#cb46-57" tabindex="-1"></a>power_exponential <span class="ot">&lt;-</span> <span class="cf">function</span>(n, m) {</span>
<span id="cb46-58"><a href="#cb46-58" tabindex="-1"></a>  results <span class="ot">&lt;-</span> <span class="fu">exponential</span>(n, m)</span>
<span id="cb46-59"><a href="#cb46-59" tabindex="-1"></a>  power_Pearson <span class="ot">&lt;-</span> <span class="fu">compute_power</span>(results<span class="sc">$</span>p_Pearson)</span>
<span id="cb46-60"><a href="#cb46-60" tabindex="-1"></a>  power_spearman <span class="ot">&lt;-</span> <span class="fu">compute_power</span>(results<span class="sc">$</span>p_spearman)</span>
<span id="cb46-61"><a href="#cb46-61" tabindex="-1"></a>  power_kendall <span class="ot">&lt;-</span> <span class="fu">compute_power</span>(results<span class="sc">$</span>p_kendall)</span>
<span id="cb46-62"><a href="#cb46-62" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&#39;Pearson相关检验的功效：&#39;</span>, power_Pearson, <span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb46-63"><a href="#cb46-63" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&#39;Spearman检验的功效：&#39;</span>, power_spearman, <span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb46-64"><a href="#cb46-64" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&#39;Kendall检验的功效：&#39;</span>, power_kendall, <span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb46-65"><a href="#cb46-65" tabindex="-1"></a>}</span>
<span id="cb46-66"><a href="#cb46-66" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1009</span>)</span>
<span id="cb46-67"><a href="#cb46-67" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb46-68"><a href="#cb46-68" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb46-69"><a href="#cb46-69" tabindex="-1"></a><span class="fu">power_bivariate_normal</span>(n, m)<span class="co"># 二元正态分布</span></span></code></pre></div>
<pre><code>## Pearson相关检验的功效： 0.061 
## Spearman检验的功效： 0.061 
## Kendall检验的功效： 0.058</code></pre>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" tabindex="-1"></a><span class="fu">power_exponential</span>(n, m)<span class="co"># 指数分布</span></span></code></pre></div>
<pre><code>## Pearson相关检验的功效： 0.037 
## Spearman检验的功效： 0.047 
## Kendall检验的功效： 0.045</code></pre>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" tabindex="-1"></a><span class="co">#  Z 统计量</span></span>
<span id="cb51-2"><a href="#cb51-2" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fl">0.651</span></span>
<span id="cb51-3"><a href="#cb51-3" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fl">0.676</span></span>
<span id="cb51-4"><a href="#cb51-4" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb51-5"><a href="#cb51-5" tabindex="-1"></a>s1 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(p1 <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> p1) <span class="sc">/</span> n)</span>
<span id="cb51-6"><a href="#cb51-6" tabindex="-1"></a>s2 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(p2 <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> p2) <span class="sc">/</span> n)</span>
<span id="cb51-7"><a href="#cb51-7" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(s1 <span class="sc">^</span> <span class="dv">2</span> <span class="sc">+</span> s2 <span class="sc">^</span> <span class="dv">2</span>)</span>
<span id="cb51-8"><a href="#cb51-8" tabindex="-1"></a>z <span class="ot">&lt;-</span> (p2 <span class="sc">-</span> p1) <span class="sc">/</span> s</span>
<span id="cb51-9"><a href="#cb51-9" tabindex="-1"></a><span class="co">#  P 值</span></span>
<span id="cb51-10"><a href="#cb51-10" tabindex="-1"></a>p<span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">pnorm</span>(<span class="sc">-</span><span class="fu">abs</span>(z))</span>
<span id="cb51-11"><a href="#cb51-11" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;p值为：&quot;</span>,p)</span></code></pre></div>
<pre><code>## p值为： 0.0001821846</code></pre>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" tabindex="-1"></a><span class="cf">if</span> (p <span class="sc">&lt;</span> <span class="fl">0.05</span>) {</span>
<span id="cb53-2"><a href="#cb53-2" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">在 0.05显著水平下，两种方法功效有显著差异。</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb53-3"><a href="#cb53-3" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb53-4"><a href="#cb53-4" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;在 0.05显著水平下，两种方法功效没有显著差异。</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb53-5"><a href="#cb53-5" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## 
## 在 0.05显著水平下，两种方法功效有显著差异。</code></pre>
<p>A-SA24204149-2024-10-14</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" tabindex="-1"></a><span class="co"># 设置参数</span></span>
<span id="cb55-2"><a href="#cb55-2" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb55-3"><a href="#cb55-3" tabindex="-1"></a>null_hypotheses <span class="ot">&lt;-</span> <span class="dv">950</span></span>
<span id="cb55-4"><a href="#cb55-4" tabindex="-1"></a>alternative_hypotheses <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb55-5"><a href="#cb55-5" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb55-6"><a href="#cb55-6" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb55-7"><a href="#cb55-7" tabindex="-1"></a></span>
<span id="cb55-8"><a href="#cb55-8" tabindex="-1"></a><span class="co"># 初始化计数器</span></span>
<span id="cb55-9"><a href="#cb55-9" tabindex="-1"></a>bonferroni_fwer <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb55-10"><a href="#cb55-10" tabindex="-1"></a>bonferroni_fdr <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb55-11"><a href="#cb55-11" tabindex="-1"></a>bonferroni_tpr <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb55-12"><a href="#cb55-12" tabindex="-1"></a>bh_fwer <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb55-13"><a href="#cb55-13" tabindex="-1"></a>bh_fdr <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb55-14"><a href="#cb55-14" tabindex="-1"></a>bh_tpr <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb55-15"><a href="#cb55-15" tabindex="-1"></a></span>
<span id="cb55-16"><a href="#cb55-16" tabindex="-1"></a><span class="co"># 进行m次模拟</span></span>
<span id="cb55-17"><a href="#cb55-17" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb55-18"><a href="#cb55-18" tabindex="-1"></a>  <span class="co"># 生成p值</span></span>
<span id="cb55-19"><a href="#cb55-19" tabindex="-1"></a>  null_p_values <span class="ot">&lt;-</span> <span class="fu">runif</span>(null_hypotheses, <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="dv">1</span>)</span>
<span id="cb55-20"><a href="#cb55-20" tabindex="-1"></a>  alternative_p_values <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(alternative_hypotheses, <span class="at">shape1 =</span> <span class="fl">0.1</span>, <span class="at">shape2 =</span> <span class="dv">1</span>)</span>
<span id="cb55-21"><a href="#cb55-21" tabindex="-1"></a>  all_p_values <span class="ot">&lt;-</span> <span class="fu">c</span>(null_p_values, alternative_p_values)</span>
<span id="cb55-22"><a href="#cb55-22" tabindex="-1"></a>  </span>
<span id="cb55-23"><a href="#cb55-23" tabindex="-1"></a>  <span class="co"># 计算原始显著性水平下的拒绝情况</span></span>
<span id="cb55-24"><a href="#cb55-24" tabindex="-1"></a>  reject_null <span class="ot">&lt;-</span> null_p_values <span class="sc">&lt;=</span> alpha</span>
<span id="cb55-25"><a href="#cb55-25" tabindex="-1"></a>  reject_alternative <span class="ot">&lt;-</span> alternative_p_values <span class="sc">&lt;=</span> alpha</span>
<span id="cb55-26"><a href="#cb55-26" tabindex="-1"></a>  </span>
<span id="cb55-27"><a href="#cb55-27" tabindex="-1"></a>  <span class="co"># Bonferroni校正</span></span>
<span id="cb55-28"><a href="#cb55-28" tabindex="-1"></a>  bonferroni_threshold <span class="ot">&lt;-</span> alpha <span class="sc">/</span> N</span>
<span id="cb55-29"><a href="#cb55-29" tabindex="-1"></a>  reject_null_bonferroni <span class="ot">&lt;-</span> null_p_values <span class="sc">&lt;=</span> bonferroni_threshold</span>
<span id="cb55-30"><a href="#cb55-30" tabindex="-1"></a>  reject_alternative_bonferroni <span class="ot">&lt;-</span> alternative_p_values <span class="sc">&lt;=</span> bonferroni_threshold</span>
<span id="cb55-31"><a href="#cb55-31" tabindex="-1"></a>  </span>
<span id="cb55-32"><a href="#cb55-32" tabindex="-1"></a>  <span class="co"># B-H校正</span></span>
<span id="cb55-33"><a href="#cb55-33" tabindex="-1"></a>  bh_threshold <span class="ot">&lt;-</span> <span class="fu">p.adjust</span>(all_p_values, <span class="at">method =</span> <span class="st">&quot;BH&quot;</span>, <span class="at">n =</span> N)</span>
<span id="cb55-34"><a href="#cb55-34" tabindex="-1"></a>  N_k<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">1000</span>,<span class="dv">1</span>)<span class="sc">*</span>alpha<span class="sc">/</span>N</span>
<span id="cb55-35"><a href="#cb55-35" tabindex="-1"></a>  reject_null_bh<span class="ot">&lt;-</span>bh_threshold<span class="sc">&lt;=</span>N_k</span>
<span id="cb55-36"><a href="#cb55-36" tabindex="-1"></a>  reject_alternative_bh <span class="ot">&lt;-</span> alternative_p_values <span class="sc">&lt;=</span> N_k</span>
<span id="cb55-37"><a href="#cb55-37" tabindex="-1"></a>  bonferroni_fwer <span class="ot">&lt;-</span> bonferroni_fwer <span class="sc">+</span> <span class="fu">sum</span>(reject_null_bonferroni) <span class="sc">/</span> null_hypotheses</span>
<span id="cb55-38"><a href="#cb55-38" tabindex="-1"></a>  bonferroni_fdr <span class="ot">&lt;-</span> bonferroni_fdr <span class="sc">+</span> <span class="fu">sum</span>(reject_null_bonferroni) <span class="sc">/</span> <span class="fu">length</span>(reject_null_bonferroni)</span>
<span id="cb55-39"><a href="#cb55-39" tabindex="-1"></a>  bonferroni_tpr <span class="ot">&lt;-</span> bonferroni_tpr <span class="sc">+</span> <span class="fu">sum</span>(reject_alternative_bonferroni) <span class="sc">/</span> alternative_hypotheses</span>
<span id="cb55-40"><a href="#cb55-40" tabindex="-1"></a>  bh_fwer <span class="ot">&lt;-</span> bh_fwer <span class="sc">+</span> <span class="fu">sum</span>(reject_null_bh) <span class="sc">/</span> null_hypotheses</span>
<span id="cb55-41"><a href="#cb55-41" tabindex="-1"></a>  bh_fdr <span class="ot">&lt;-</span> bh_fdr <span class="sc">+</span> <span class="fu">sum</span>(reject_null_bh) <span class="sc">/</span> <span class="fu">length</span>(reject_null_bh)</span>
<span id="cb55-42"><a href="#cb55-42" tabindex="-1"></a>  bh_tpr <span class="ot">&lt;-</span> bh_tpr <span class="sc">+</span> <span class="fu">sum</span>(reject_alternative_bh) <span class="sc">/</span> alternative_hypotheses</span>
<span id="cb55-43"><a href="#cb55-43" tabindex="-1"></a>}</span>
<span id="cb55-44"><a href="#cb55-44" tabindex="-1"></a>bonferroni_fwer <span class="ot">&lt;-</span> bonferroni_fwer <span class="sc">/</span> m</span>
<span id="cb55-45"><a href="#cb55-45" tabindex="-1"></a>bonferroni_fdr <span class="ot">&lt;-</span> bonferroni_fdr <span class="sc">/</span> m</span>
<span id="cb55-46"><a href="#cb55-46" tabindex="-1"></a>bonferroni_tpr <span class="ot">&lt;-</span> bonferroni_tpr <span class="sc">/</span> m</span>
<span id="cb55-47"><a href="#cb55-47" tabindex="-1"></a>bh_fwer <span class="ot">&lt;-</span> bh_fwer <span class="sc">/</span> m</span>
<span id="cb55-48"><a href="#cb55-48" tabindex="-1"></a>bh_fdr <span class="ot">&lt;-</span> bh_fdr <span class="sc">/</span> m</span>
<span id="cb55-49"><a href="#cb55-49" tabindex="-1"></a>bh_tpr <span class="ot">&lt;-</span> bh_tpr <span class="sc">/</span> m</span>
<span id="cb55-50"><a href="#cb55-50" tabindex="-1"></a>result_table <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(bonferroni_fwer, bonferroni_fdr, bonferroni_tpr,bh_fwer, bh_fdr, bh_tpr), <span class="at">nrow =</span> <span class="dv">3</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb55-51"><a href="#cb55-51" tabindex="-1"></a><span class="fu">colnames</span>(result_table) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Bonferroni &quot;</span>, <span class="st">&quot;B-H &quot;</span>)</span>
<span id="cb55-52"><a href="#cb55-52" tabindex="-1"></a><span class="fu">rownames</span>(result_table) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;FWER&quot;</span>, <span class="st">&quot;FDR&quot;</span>, <span class="st">&quot;TPR&quot;</span>)</span>
<span id="cb55-53"><a href="#cb55-53" tabindex="-1"></a><span class="fu">print</span>(result_table)</span></code></pre></div>
<pre><code>##       Bonferroni          B-H 
## FWER 9.694737e-05 9.694737e-05
## FDR  3.982360e-01 3.087979e-02
## TPR  2.933580e-02 1.443997e+01</code></pre>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" tabindex="-1"></a>times <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">18</span>, <span class="dv">43</span>, <span class="dv">85</span>, <span class="dv">91</span>, <span class="dv">98</span>, <span class="dv">100</span>, <span class="dv">130</span>, <span class="dv">230</span>, <span class="dv">487</span>)</span>
<span id="cb57-2"><a href="#cb57-2" tabindex="-1"></a><span class="co"># 危险率lambda的极大似然估计值</span></span>
<span id="cb57-3"><a href="#cb57-3" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(times)</span>
<span id="cb57-4"><a href="#cb57-4" tabindex="-1"></a>lambda_hat <span class="ot">&lt;-</span> n<span class="sc">/</span><span class="fu">sum</span>(times)</span>
<span id="cb57-5"><a href="#cb57-5" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;MLE of the hazard rate lambda：&quot;</span>, lambda_hat, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## MLE of the hazard rate lambda： 0.00925212</code></pre>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb59-2"><a href="#cb59-2" tabindex="-1"></a><span class="co"># Bootstrap</span></span>
<span id="cb59-3"><a href="#cb59-3" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="dv">1000</span> <span class="co"># 设置自助抽样次数</span></span>
<span id="cb59-4"><a href="#cb59-4" tabindex="-1"></a>lambda_boot <span class="ot">&lt;-</span> <span class="fu">numeric</span>(B)</span>
<span id="cb59-5"><a href="#cb59-5" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B) {</span>
<span id="cb59-6"><a href="#cb59-6" tabindex="-1"></a>  boot_sample <span class="ot">&lt;-</span> <span class="fu">sample</span>(times, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb59-7"><a href="#cb59-7" tabindex="-1"></a>  lambda_boot[i] <span class="ot">&lt;-</span> <span class="fu">length</span>(boot_sample)<span class="sc">/</span><span class="fu">sum</span>(boot_sample)</span>
<span id="cb59-8"><a href="#cb59-8" tabindex="-1"></a>}</span>
<span id="cb59-9"><a href="#cb59-9" tabindex="-1"></a></span>
<span id="cb59-10"><a href="#cb59-10" tabindex="-1"></a>bias <span class="ot">&lt;-</span> <span class="fu">mean</span>(lambda_boot) <span class="sc">-</span> lambda_hat</span>
<span id="cb59-11"><a href="#cb59-11" tabindex="-1"></a>se <span class="ot">&lt;-</span> <span class="fu">sd</span>(lambda_boot)</span>
<span id="cb59-12"><a href="#cb59-12" tabindex="-1"></a></span>
<span id="cb59-13"><a href="#cb59-13" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Bias:&quot;</span>, bias, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Bias: 0.001186423</code></pre>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Standard error:&quot;</span>, se)</span></code></pre></div>
<pre><code>## Standard error: 0.00448192</code></pre>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb63-2"><a href="#cb63-2" tabindex="-1"></a><span class="co"># 计算平均故障间隔时间</span></span>
<span id="cb63-3"><a href="#cb63-3" tabindex="-1"></a>mean_time <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>lambda_hat</span>
<span id="cb63-4"><a href="#cb63-4" tabindex="-1"></a></span>
<span id="cb63-5"><a href="#cb63-5" tabindex="-1"></a><span class="co"># 计算 95%置信区间</span></span>
<span id="cb63-6"><a href="#cb63-6" tabindex="-1"></a><span class="do">## 标准正态方法</span></span>
<span id="cb63-7"><a href="#cb63-7" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="fl">0.975</span>)</span>
<span id="cb63-8"><a href="#cb63-8" tabindex="-1"></a>normal_interval <span class="ot">&lt;-</span> mean_time <span class="sc">+</span> <span class="fu">c</span>(<span class="sc">-</span>z <span class="sc">*</span> se, z <span class="sc">*</span> se) <span class="sc">*</span> (<span class="dv">1</span><span class="sc">/</span>lambda_hat<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb63-9"><a href="#cb63-9" tabindex="-1"></a></span>
<span id="cb63-10"><a href="#cb63-10" tabindex="-1"></a><span class="do">## 基本方法</span></span>
<span id="cb63-11"><a href="#cb63-11" tabindex="-1"></a>basic_interval <span class="ot">&lt;-</span> <span class="fu">quantile</span>(lambda_boot, <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>))</span>
<span id="cb63-12"><a href="#cb63-12" tabindex="-1"></a>basic_interval <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>basic_interval</span>
<span id="cb63-13"><a href="#cb63-13" tabindex="-1"></a></span>
<span id="cb63-14"><a href="#cb63-14" tabindex="-1"></a><span class="do">## 百分位数方法</span></span>
<span id="cb63-15"><a href="#cb63-15" tabindex="-1"></a>percentile_interval <span class="ot">&lt;-</span> <span class="fu">quantile</span>(<span class="dv">1</span><span class="sc">/</span>lambda_boot, <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>))</span>
<span id="cb63-16"><a href="#cb63-16" tabindex="-1"></a></span>
<span id="cb63-17"><a href="#cb63-17" tabindex="-1"></a><span class="do">## BCa方法</span></span>
<span id="cb63-18"><a href="#cb63-18" tabindex="-1"></a>boot_obj <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data =</span> times, <span class="at">statistic =</span> <span class="cf">function</span>(x, i) {</span>
<span id="cb63-19"><a href="#cb63-19" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(x[i])</span>
<span id="cb63-20"><a href="#cb63-20" tabindex="-1"></a>  <span class="fu">return</span>(n<span class="sc">/</span><span class="fu">sum</span>(x[i]))</span>
<span id="cb63-21"><a href="#cb63-21" tabindex="-1"></a>}, <span class="at">R =</span> B)</span>
<span id="cb63-22"><a href="#cb63-22" tabindex="-1"></a>bca_interval <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(boot_obj, <span class="at">type =</span> <span class="st">&quot;bca&quot;</span>)<span class="sc">$</span>bca[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb63-23"><a href="#cb63-23" tabindex="-1"></a>bca_interval <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>bca_interval</span>
<span id="cb63-24"><a href="#cb63-24" tabindex="-1"></a></span>
<span id="cb63-25"><a href="#cb63-25" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;标准正态法 95%置信区间：[&quot;</span>, normal_interval[<span class="dv">1</span>], <span class="st">&quot;,&quot;</span>, normal_interval[<span class="dv">2</span>], <span class="st">&quot;]</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 标准正态法 95%置信区间：[ 5.463895 , 210.7028 ]</code></pre>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;基本方法 95%置信区间：[&quot;</span>, basic_interval[<span class="dv">2</span>], <span class="st">&quot;,&quot;</span>, basic_interval[<span class="dv">1</span>], <span class="st">&quot;]</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 基本方法 95%置信区间：[ 44.74791 , 187.6791 ]</code></pre>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;分位数法 95%置信区间：[&quot;</span>, percentile_interval[<span class="dv">1</span>], <span class="st">&quot;,&quot;</span>, percentile_interval[<span class="dv">2</span>], <span class="st">&quot;]</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 分位数法 95%置信区间：[ 44.74792 , 187.6792 ]</code></pre>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;BCa法 95%置信区间：[&quot;</span>, bca_interval[<span class="dv">2</span>], <span class="st">&quot;,&quot;</span>, bca_interval[<span class="dv">1</span>], <span class="st">&quot;]</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## BCa法 95%置信区间：[ 56.16667 , 221.4676 ]</code></pre>
<p>A-SA24204149-2024-10-21</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" tabindex="-1"></a><span class="do">##7.8</span></span>
<span id="cb71-2"><a href="#cb71-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb71-3"><a href="#cb71-3" tabindex="-1"></a>sc<span class="ot">&lt;-</span>scor</span>
<span id="cb71-4"><a href="#cb71-4" tabindex="-1"></a><span class="co"># 计算theta的函数</span></span>
<span id="cb71-5"><a href="#cb71-5" tabindex="-1"></a>estimate_theta <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb71-6"><a href="#cb71-6" tabindex="-1"></a>    <span class="fu">cov</span>(x) <span class="sc">%&gt;%</span></span>
<span id="cb71-7"><a href="#cb71-7" tabindex="-1"></a>    <span class="fu">prcomp</span>() <span class="sc">%&gt;%</span></span>
<span id="cb71-8"><a href="#cb71-8" tabindex="-1"></a>    {.<span class="sc">$</span>sdev[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(.<span class="sc">$</span>sdev)}</span>
<span id="cb71-9"><a href="#cb71-9" tabindex="-1"></a>}</span>
<span id="cb71-10"><a href="#cb71-10" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="fu">nrow</span>(sc)</span>
<span id="cb71-11"><a href="#cb71-11" tabindex="-1"></a>theta.j<span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb71-12"><a href="#cb71-12" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){    </span>
<span id="cb71-13"><a href="#cb71-13" tabindex="-1"></a>  theta.j[i]<span class="ot">&lt;-</span><span class="fu">estimate_theta</span>(sc[<span class="sc">-</span>i,])</span>
<span id="cb71-14"><a href="#cb71-14" tabindex="-1"></a>}</span>
<span id="cb71-15"><a href="#cb71-15" tabindex="-1"></a>theta.hat<span class="ot">&lt;-</span><span class="fu">estimate_theta</span>(sc)</span>
<span id="cb71-16"><a href="#cb71-16" tabindex="-1"></a>bias<span class="ot">&lt;-</span>(n<span class="dv">-1</span>)<span class="sc">*</span>(<span class="fu">mean</span>(theta.j)<span class="sc">-</span>theta.hat) <span class="co">#BIAS</span></span>
<span id="cb71-17"><a href="#cb71-17" tabindex="-1"></a>se<span class="ot">&lt;-</span><span class="fu">sqrt</span>((n<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">var</span>(theta.j)) <span class="co">#SE</span></span>
<span id="cb71-18"><a href="#cb71-18" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Bias:&quot;</span>, <span class="fu">round</span>(bias,<span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Bias: 0.014</code></pre>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;standard error:&quot;</span>, <span class="fu">round</span>(se,<span class="dv">3</span>),<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## standard error: 0.053</code></pre>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" tabindex="-1"></a><span class="co">#8.2</span></span>
<span id="cb75-2"><a href="#cb75-2" tabindex="-1"></a><span class="co"># 置换检验函数</span></span>
<span id="cb75-3"><a href="#cb75-3" tabindex="-1"></a>permutation_test_spearman <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, <span class="at">B =</span> <span class="dv">1000</span>) {</span>
<span id="cb75-4"><a href="#cb75-4" tabindex="-1"></a>  observed_stat <span class="ot">&lt;-</span> <span class="fu">cor</span>(x, y, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb75-5"><a href="#cb75-5" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb75-6"><a href="#cb75-6" tabindex="-1"></a>  stats <span class="ot">&lt;-</span> <span class="fu">numeric</span>(B)</span>
<span id="cb75-7"><a href="#cb75-7" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B) {</span>
<span id="cb75-8"><a href="#cb75-8" tabindex="-1"></a>    permuted_y <span class="ot">&lt;-</span> <span class="fu">sample</span>(y)</span>
<span id="cb75-9"><a href="#cb75-9" tabindex="-1"></a>    stats[i] <span class="ot">&lt;-</span> <span class="fu">cor</span>(x, permuted_y, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb75-10"><a href="#cb75-10" tabindex="-1"></a>  }</span>
<span id="cb75-11"><a href="#cb75-11" tabindex="-1"></a>  p_value <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">abs</span>(stats) <span class="sc">&gt;=</span> <span class="fu">abs</span>(observed_stat))</span>
<span id="cb75-12"><a href="#cb75-12" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">observed_statistic =</span> observed_stat, <span class="at">p_value =</span> p_value))</span>
<span id="cb75-13"><a href="#cb75-13" tabindex="-1"></a>}</span>
<span id="cb75-14"><a href="#cb75-14" tabindex="-1"></a></span>
<span id="cb75-15"><a href="#cb75-15" tabindex="-1"></a><span class="co"># 生成随机数据</span></span>
<span id="cb75-16"><a href="#cb75-16" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb75-17"><a href="#cb75-17" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="fl">1e3</span>)</span>
<span id="cb75-18"><a href="#cb75-18" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="fl">1e3</span>)</span>
<span id="cb75-19"><a href="#cb75-19" tabindex="-1"></a></span>
<span id="cb75-20"><a href="#cb75-20" tabindex="-1"></a>perm_result <span class="ot">&lt;-</span> <span class="fu">permutation_test_spearman</span>(x, y)</span>
<span id="cb75-21"><a href="#cb75-21" tabindex="-1"></a>cor_test_result <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(x, y, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb75-22"><a href="#cb75-22" tabindex="-1"></a></span>
<span id="cb75-23"><a href="#cb75-23" tabindex="-1"></a><span class="co"># 结果打印</span></span>
<span id="cb75-24"><a href="#cb75-24" tabindex="-1"></a><span class="fu">round</span>(perm_result<span class="sc">$</span>observed_statistic, <span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb75-25"><a href="#cb75-25" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Observed Spearman correlation statistic from permutation test:&quot;</span>,</span>
<span id="cb75-26"><a href="#cb75-26" tabindex="-1"></a>      .,</span>
<span id="cb75-27"><a href="#cb75-27" tabindex="-1"></a>      <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Observed Spearman correlation statistic from permutation test: -0.01</code></pre>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" tabindex="-1"></a><span class="fu">round</span>(perm_result<span class="sc">$</span>p_value, <span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb77-2"><a href="#cb77-2" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;P-value from permutation test:&quot;</span>, ., <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## P-value from permutation test: 0.77</code></pre>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" tabindex="-1"></a><span class="fu">round</span>(cor_test_result<span class="sc">$</span>p.value, <span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb79-2"><a href="#cb79-2" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;P-value from cor.test:&quot;</span>, ., <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## P-value from cor.test: 0.745</code></pre>
<p>A-SA24204149-2024-10-28</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" tabindex="-1"></a><span class="do">##9.3</span></span>
<span id="cb81-2"><a href="#cb81-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb81-3"><a href="#cb81-3" tabindex="-1"></a><span class="co"># 设置参数</span></span>
<span id="cb81-4"><a href="#cb81-4" tabindex="-1"></a>theta <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb81-5"><a href="#cb81-5" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb81-6"><a href="#cb81-6" tabindex="-1"></a>n_samples <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb81-7"><a href="#cb81-7" tabindex="-1"></a>delete<span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb81-8"><a href="#cb81-8" tabindex="-1"></a></span>
<span id="cb81-9"><a href="#cb81-9" tabindex="-1"></a><span class="co"># Metropolis-Hastings采样器函数</span></span>
<span id="cb81-10"><a href="#cb81-10" tabindex="-1"></a>metropolis_hastings <span class="ot">&lt;-</span> <span class="cf">function</span>(n_samples, theta, a, delete) {</span>
<span id="cb81-11"><a href="#cb81-11" tabindex="-1"></a>  samples <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_samples)</span>
<span id="cb81-12"><a href="#cb81-12" tabindex="-1"></a>  current_sample <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb81-13"><a href="#cb81-13" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_samples) {</span>
<span id="cb81-14"><a href="#cb81-14" tabindex="-1"></a>    proposal <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> current_sample, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb81-15"><a href="#cb81-15" tabindex="-1"></a>    acceptance_ratio <span class="ot">&lt;-</span> <span class="fu">dcauchy</span>(proposal, <span class="at">location =</span> a, <span class="at">scale =</span> theta) <span class="sc">/</span> <span class="fu">dcauchy</span>(current_sample, <span class="at">location =</span> a, <span class="at">scale =</span> theta)</span>
<span id="cb81-16"><a href="#cb81-16" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">runif</span>(<span class="dv">1</span>) <span class="sc">&lt;</span> acceptance_ratio) {</span>
<span id="cb81-17"><a href="#cb81-17" tabindex="-1"></a>      current_sample <span class="ot">&lt;-</span> proposal</span>
<span id="cb81-18"><a href="#cb81-18" tabindex="-1"></a>    }</span>
<span id="cb81-19"><a href="#cb81-19" tabindex="-1"></a>    samples[i] <span class="ot">&lt;-</span> current_sample</span>
<span id="cb81-20"><a href="#cb81-20" tabindex="-1"></a>  }</span>
<span id="cb81-21"><a href="#cb81-21" tabindex="-1"></a>  <span class="fu">return</span>(samples[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span>delete)])</span>
<span id="cb81-22"><a href="#cb81-22" tabindex="-1"></a>}</span>
<span id="cb81-23"><a href="#cb81-23" tabindex="-1"></a></span>
<span id="cb81-24"><a href="#cb81-24" tabindex="-1"></a><span class="co"># 生成样本</span></span>
<span id="cb81-25"><a href="#cb81-25" tabindex="-1"></a>generated_samples <span class="ot">&lt;-</span> <span class="fu">metropolis_hastings</span>(n_samples, theta, a, delete)</span>
<span id="cb81-26"><a href="#cb81-26" tabindex="-1"></a></span>
<span id="cb81-27"><a href="#cb81-27" tabindex="-1"></a><span class="co"># 计算并比较分位数</span></span>
<span id="cb81-28"><a href="#cb81-28" tabindex="-1"></a>true_quantiles <span class="ot">&lt;-</span> <span class="fu">qcauchy</span>(<span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>, <span class="at">by =</span> <span class="fl">0.1</span>), <span class="at">location =</span> a, <span class="at">scale =</span> theta)</span>
<span id="cb81-29"><a href="#cb81-29" tabindex="-1"></a>generated_quantiles <span class="ot">&lt;-</span> <span class="fu">quantile</span>(generated_samples, <span class="at">probs =</span> <span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>, <span class="at">by =</span> <span class="fl">0.1</span>))</span>
<span id="cb81-30"><a href="#cb81-30" tabindex="-1"></a></span>
<span id="cb81-31"><a href="#cb81-31" tabindex="-1"></a><span class="co"># 输出结果</span></span>
<span id="cb81-32"><a href="#cb81-32" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;True Cauchy Quantiles:&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;True Cauchy Quantiles:&quot;</code></pre>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" tabindex="-1"></a><span class="fu">print</span>(true_quantiles)</span></code></pre></div>
<pre><code>## [1] -3.0776835 -1.3763819 -0.7265425 -0.3249197  0.0000000  0.3249197  0.7265425
## [8]  1.3763819  3.0776835</code></pre>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;Generated Cauchy Quantiles:&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;Generated Cauchy Quantiles:&quot;</code></pre>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" tabindex="-1"></a><span class="fu">print</span>(generated_quantiles)</span></code></pre></div>
<pre><code>##         10%         20%         30%         40%         50%         60% 
## -2.81748908 -1.40266892 -0.73784530 -0.33350883 -0.01670368  0.30706020 
##         70%         80%         90% 
##  0.72330174  1.37266697  3.02836810</code></pre>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" tabindex="-1"></a><span class="do">##9.8</span></span>
<span id="cb89-2"><a href="#cb89-2" tabindex="-1"></a><span class="co"># 设置参数</span></span>
<span id="cb89-3"><a href="#cb89-3" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb89-4"><a href="#cb89-4" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb89-5"><a href="#cb89-5" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb89-6"><a href="#cb89-6" tabindex="-1"></a>num_samples <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb89-7"><a href="#cb89-7" tabindex="-1"></a></span>
<span id="cb89-8"><a href="#cb89-8" tabindex="-1"></a><span class="co"># 初始化x和y</span></span>
<span id="cb89-9"><a href="#cb89-9" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">0</span><span class="sc">:</span>n, <span class="dv">1</span>)</span>
<span id="cb89-10"><a href="#cb89-10" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb89-11"><a href="#cb89-11" tabindex="-1"></a></span>
<span id="cb89-12"><a href="#cb89-12" tabindex="-1"></a><span class="co"># 容器用于存储样本</span></span>
<span id="cb89-13"><a href="#cb89-13" tabindex="-1"></a>samples_x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(num_samples)</span>
<span id="cb89-14"><a href="#cb89-14" tabindex="-1"></a>samples_y <span class="ot">&lt;-</span> <span class="fu">numeric</span>(num_samples)</span>
<span id="cb89-15"><a href="#cb89-15" tabindex="-1"></a></span>
<span id="cb89-16"><a href="#cb89-16" tabindex="-1"></a><span class="co"># Gibbs采样循环</span></span>
<span id="cb89-17"><a href="#cb89-17" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>num_samples) {</span>
<span id="cb89-18"><a href="#cb89-18" tabindex="-1"></a>  <span class="co"># 从条件分布中采样x给定y</span></span>
<span id="cb89-19"><a href="#cb89-19" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="at">size =</span> n, <span class="at">prob =</span> <span class="fu">dbinom</span>(<span class="dv">0</span><span class="sc">:</span>n, <span class="at">size =</span> n, <span class="at">prob =</span> y))</span>
<span id="cb89-20"><a href="#cb89-20" tabindex="-1"></a>  samples_x[i] <span class="ot">&lt;-</span> x</span>
<span id="cb89-21"><a href="#cb89-21" tabindex="-1"></a>  </span>
<span id="cb89-22"><a href="#cb89-22" tabindex="-1"></a>  <span class="co"># 从条件分布中采样y给定x</span></span>
<span id="cb89-23"><a href="#cb89-23" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>, <span class="at">shape1 =</span> x <span class="sc">+</span> a, <span class="at">shape2 =</span> n <span class="sc">-</span> x <span class="sc">+</span> b)</span>
<span id="cb89-24"><a href="#cb89-24" tabindex="-1"></a>  samples_y[i] <span class="ot">&lt;-</span> y</span>
<span id="cb89-25"><a href="#cb89-25" tabindex="-1"></a>}</span>
<span id="cb89-26"><a href="#cb89-26" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">mean</span>(samples_x))</span></code></pre></div>
<pre><code>## [1] 1.8814</code></pre>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">mean</span>(samples_y))<span class="do">##输出平均值</span></span></code></pre></div>
<pre><code>## [1] 0.2583071</code></pre>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" tabindex="-1"></a><span class="do">##For each of the above exercise, use the Gelman-Rubin method to monitor convergence of the chain, and run the chain until it converges approximately to the target distribution according to Rˆ &lt; 1.2</span></span>
<span id="cb93-2"><a href="#cb93-2" tabindex="-1"></a></span>
<span id="cb93-3"><a href="#cb93-3" tabindex="-1"></a></span>
<span id="cb93-4"><a href="#cb93-4" tabindex="-1"></a><span class="co"># 假设我们已经有一个MCMC样本数据，这里用一个模拟的例子</span></span>
<span id="cb93-5"><a href="#cb93-5" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb93-6"><a href="#cb93-6" tabindex="-1"></a>num_chains <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb93-7"><a href="#cb93-7" tabindex="-1"></a>chain_length <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb93-8"><a href="#cb93-8" tabindex="-1"></a>mcmc_chains <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb93-9"><a href="#cb93-9" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>num_chains) {</span>
<span id="cb93-10"><a href="#cb93-10" tabindex="-1"></a>  mcmc_chains[[i]] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(chain_length, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb93-11"><a href="#cb93-11" tabindex="-1"></a>}</span>
<span id="cb93-12"><a href="#cb93-12" tabindex="-1"></a></span>
<span id="cb93-13"><a href="#cb93-13" tabindex="-1"></a><span class="co"># 将链转换为矩阵形式</span></span>
<span id="cb93-14"><a href="#cb93-14" tabindex="-1"></a>mcmc_matrix <span class="ot">&lt;-</span> <span class="fu">do.call</span>(cbind, mcmc_chains)</span>
<span id="cb93-15"><a href="#cb93-15" tabindex="-1"></a></span>
<span id="cb93-16"><a href="#cb93-16" tabindex="-1"></a><span class="co"># 定义一个函数来计算Gelman-Rubin统计量</span></span>
<span id="cb93-17"><a href="#cb93-17" tabindex="-1"></a>gelman_rubin <span class="ot">&lt;-</span> <span class="cf">function</span>(chains) {</span>
<span id="cb93-18"><a href="#cb93-18" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(chains)</span>
<span id="cb93-19"><a href="#cb93-19" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="fu">ncol</span>(chains)</span>
<span id="cb93-20"><a href="#cb93-20" tabindex="-1"></a>  B <span class="ot">&lt;-</span> <span class="fu">var</span>(<span class="fu">apply</span>(chains, <span class="dv">2</span>, mean))</span>
<span id="cb93-21"><a href="#cb93-21" tabindex="-1"></a>  W <span class="ot">&lt;-</span> <span class="fu">apply</span>(chains, <span class="dv">2</span>, var)</span>
<span id="cb93-22"><a href="#cb93-22" tabindex="-1"></a>  mean_W <span class="ot">&lt;-</span> <span class="fu">mean</span>(W)</span>
<span id="cb93-23"><a href="#cb93-23" tabindex="-1"></a>  var_plus <span class="ot">&lt;-</span> (m <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">/</span> m <span class="sc">*</span> W <span class="sc">+</span> (n <span class="sc">/</span> m) <span class="sc">*</span> B</span>
<span id="cb93-24"><a href="#cb93-24" tabindex="-1"></a>  R_hat <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(var_plus <span class="sc">/</span> W)</span>
<span id="cb93-25"><a href="#cb93-25" tabindex="-1"></a>  <span class="fu">return</span>(R_hat)</span>
<span id="cb93-26"><a href="#cb93-26" tabindex="-1"></a>}</span>
<span id="cb93-27"><a href="#cb93-27" tabindex="-1"></a></span>
<span id="cb93-28"><a href="#cb93-28" tabindex="-1"></a><span class="co"># 初始计算Gelman-Rubin统计量</span></span>
<span id="cb93-29"><a href="#cb93-29" tabindex="-1"></a>R_hat <span class="ot">&lt;-</span> <span class="fu">gelman_rubin</span>(mcmc_matrix)</span>
<span id="cb93-30"><a href="#cb93-30" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Initial Gelman-Rubin statistic:&quot;</span>, R_hat, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Initial Gelman-Rubin statistic: 0.9910928 0.9878419 0.9936138 0.9909711 0.9894456</code></pre>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" tabindex="-1"></a><span class="co"># 循环采样直到收敛</span></span>
<span id="cb95-2"><a href="#cb95-2" tabindex="-1"></a><span class="cf">while</span> (<span class="fu">any</span>(R_hat <span class="sc">&gt;</span> <span class="fl">1.2</span>)) {</span>
<span id="cb95-3"><a href="#cb95-3" tabindex="-1"></a>  <span class="co"># 增加新的样本点到每个链中</span></span>
<span id="cb95-4"><a href="#cb95-4" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>num_chains) {</span>
<span id="cb95-5"><a href="#cb95-5" tabindex="-1"></a>    new_samples <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(chain_length, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb95-6"><a href="#cb95-6" tabindex="-1"></a>    mcmc_chains[[i]] <span class="ot">&lt;-</span> <span class="fu">c</span>(mcmc_chains[[i]], new_samples)</span>
<span id="cb95-7"><a href="#cb95-7" tabindex="-1"></a>  }</span>
<span id="cb95-8"><a href="#cb95-8" tabindex="-1"></a>  </span>
<span id="cb95-9"><a href="#cb95-9" tabindex="-1"></a>  <span class="co"># 更新矩阵</span></span>
<span id="cb95-10"><a href="#cb95-10" tabindex="-1"></a>  mcmc_matrix <span class="ot">&lt;-</span> <span class="fu">do.call</span>(cbind, mcmc_chains)</span>
<span id="cb95-11"><a href="#cb95-11" tabindex="-1"></a>  </span>
<span id="cb95-12"><a href="#cb95-12" tabindex="-1"></a>  <span class="co"># 重新计算Gelman-Rubin统计量</span></span>
<span id="cb95-13"><a href="#cb95-13" tabindex="-1"></a>  R_hat <span class="ot">&lt;-</span> <span class="fu">gelman_rubin</span>(mcmc_matrix)</span>
<span id="cb95-14"><a href="#cb95-14" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Updated Gelman-Rubin statistic:&quot;</span>, R_hat, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb95-15"><a href="#cb95-15" tabindex="-1"></a>}</span>
<span id="cb95-16"><a href="#cb95-16" tabindex="-1"></a></span>
<span id="cb95-17"><a href="#cb95-17" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;少于 1.2</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 少于 1.2</code></pre>
<p>A-SA24204149-2024-11-04</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" tabindex="-1"></a><span class="do">##11.3</span></span>
<span id="cb97-2"><a href="#cb97-2" tabindex="-1"></a></span>
<span id="cb97-3"><a href="#cb97-3" tabindex="-1"></a>compute_kth_term <span class="ot">&lt;-</span> <span class="cf">function</span>(k, a) {</span>
<span id="cb97-4"><a href="#cb97-4" tabindex="-1"></a>  d <span class="ot">&lt;-</span> <span class="fu">length</span>(a)</span>
<span id="cb97-5"><a href="#cb97-5" tabindex="-1"></a>  norm_a <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">sum</span>(a<span class="sc">^</span><span class="dv">2</span>))  <span class="co"># Euclidean norm</span></span>
<span id="cb97-6"><a href="#cb97-6" tabindex="-1"></a>  term <span class="ot">&lt;-</span> (<span class="sc">-</span><span class="dv">1</span>)<span class="sc">^</span>k <span class="sc">/</span> (<span class="fu">factorial</span>(k) <span class="sc">*</span> <span class="dv">2</span><span class="sc">^</span>k) <span class="sc">*</span> (norm_a<span class="sc">^</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">2</span>)) <span class="sc">/</span> ((<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">2</span>)) <span class="sc">*</span></span>
<span id="cb97-7"><a href="#cb97-7" tabindex="-1"></a>    <span class="fu">gamma</span>((d<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>) <span class="sc">*</span> <span class="fu">gamma</span>(k <span class="sc">+</span> <span class="dv">3</span><span class="sc">/</span><span class="dv">2</span>) <span class="sc">/</span> <span class="fu">gamma</span>(k <span class="sc">+</span> d<span class="sc">/</span><span class="dv">2</span> <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb97-8"><a href="#cb97-8" tabindex="-1"></a>  <span class="fu">return</span>(term)</span>
<span id="cb97-9"><a href="#cb97-9" tabindex="-1"></a>}</span>
<span id="cb97-10"><a href="#cb97-10" tabindex="-1"></a></span>
<span id="cb97-11"><a href="#cb97-11" tabindex="-1"></a><span class="co"># function to compute sum</span></span>
<span id="cb97-12"><a href="#cb97-12" tabindex="-1"></a>compute_sum <span class="ot">&lt;-</span> <span class="cf">function</span>(a, <span class="at">tol =</span> <span class="fl">1e-10</span>) {</span>
<span id="cb97-13"><a href="#cb97-13" tabindex="-1"></a>  norm_a <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">sum</span>(a<span class="sc">^</span><span class="dv">2</span>))  <span class="co"># Euclidean norm</span></span>
<span id="cb97-14"><a href="#cb97-14" tabindex="-1"></a>  sum_series <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb97-15"><a href="#cb97-15" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb97-16"><a href="#cb97-16" tabindex="-1"></a>  term <span class="ot">&lt;-</span> <span class="fu">compute_kth_term</span>(k, a)</span>
<span id="cb97-17"><a href="#cb97-17" tabindex="-1"></a>  <span class="cf">while</span> (<span class="fu">abs</span>(term) <span class="sc">&gt;</span> tol) {</span>
<span id="cb97-18"><a href="#cb97-18" tabindex="-1"></a>    sum_series <span class="ot">&lt;-</span> sum_series <span class="sc">+</span> term</span>
<span id="cb97-19"><a href="#cb97-19" tabindex="-1"></a>    k <span class="ot">&lt;-</span> k <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb97-20"><a href="#cb97-20" tabindex="-1"></a>    term <span class="ot">&lt;-</span> <span class="fu">compute_kth_term</span>(k, a)</span>
<span id="cb97-21"><a href="#cb97-21" tabindex="-1"></a>  }</span>
<span id="cb97-22"><a href="#cb97-22" tabindex="-1"></a>  <span class="fu">return</span>(sum_series)</span>
<span id="cb97-23"><a href="#cb97-23" tabindex="-1"></a>}</span>
<span id="cb97-24"><a href="#cb97-24" tabindex="-1"></a></span>
<span id="cb97-25"><a href="#cb97-25" tabindex="-1"></a><span class="co"># Evaluate the sum when a=(1,2)</span></span>
<span id="cb97-26"><a href="#cb97-26" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb97-27"><a href="#cb97-27" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">compute_sum</span>(a)</span>
<span id="cb97-28"><a href="#cb97-28" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&#39;sum when a = (1,2) :&#39;</span>, result)</span></code></pre></div>
<pre><code>## sum when a = (1,2) : 1.532164</code></pre>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" tabindex="-1"></a><span class="do">##11.5</span></span>
<span id="cb99-2"><a href="#cb99-2" tabindex="-1"></a>define_equation <span class="ot">&lt;-</span> <span class="cf">function</span>(k, a){</span>
<span id="cb99-3"><a href="#cb99-3" tabindex="-1"></a>  int_func <span class="ot">&lt;-</span> <span class="cf">function</span>(u, n){(<span class="dv">1</span> <span class="sc">+</span> u<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(n <span class="sc">-</span> <span class="dv">1</span>))<span class="sc">^</span>(<span class="sc">-</span>n<span class="sc">/</span><span class="dv">2</span>)}</span>
<span id="cb99-4"><a href="#cb99-4" tabindex="-1"></a>  get_c <span class="ot">&lt;-</span> <span class="cf">function</span>(n, a){<span class="fu">sqrt</span>(a<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> n <span class="sc">/</span> (n <span class="sc">+</span> <span class="dv">1</span> <span class="sc">-</span> a<span class="sc">^</span><span class="dv">2</span>))}</span>
<span id="cb99-5"><a href="#cb99-5" tabindex="-1"></a>  expr <span class="ot">&lt;-</span> <span class="cf">function</span>(n, a) {</span>
<span id="cb99-6"><a href="#cb99-6" tabindex="-1"></a>    this_int_func <span class="ot">&lt;-</span> <span class="cf">function</span>(u){</span>
<span id="cb99-7"><a href="#cb99-7" tabindex="-1"></a>      <span class="fu">int_func</span>(u, n)}</span>
<span id="cb99-8"><a href="#cb99-8" tabindex="-1"></a>    c_val <span class="ot">&lt;-</span> <span class="fu">get_c</span>(n <span class="sc">-</span> <span class="dv">1</span>, a)</span>
<span id="cb99-9"><a href="#cb99-9" tabindex="-1"></a>    <span class="dv">2</span><span class="sc">/</span><span class="fu">sqrt</span>(pi<span class="sc">*</span>(n <span class="sc">-</span> <span class="dv">1</span>)) <span class="sc">*</span> <span class="fu">exp</span>(<span class="fu">lgamma</span>(n<span class="sc">/</span><span class="dv">2</span>)<span class="sc">-</span><span class="fu">lgamma</span>((n <span class="sc">-</span> <span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>)) <span class="sc">*</span> </span>
<span id="cb99-10"><a href="#cb99-10" tabindex="-1"></a>      <span class="fu">integrate</span>(this_int_func, <span class="at">lower =</span> <span class="dv">0</span>, <span class="at">upper =</span> c_val)<span class="sc">$</span>value}</span>
<span id="cb99-11"><a href="#cb99-11" tabindex="-1"></a>  </span>
<span id="cb99-12"><a href="#cb99-12" tabindex="-1"></a>  lhs <span class="ot">&lt;-</span> <span class="fu">expr</span>(k, a)</span>
<span id="cb99-13"><a href="#cb99-13" tabindex="-1"></a>  rhs <span class="ot">&lt;-</span> <span class="fu">expr</span>(k <span class="sc">+</span> <span class="dv">1</span>, a)</span>
<span id="cb99-14"><a href="#cb99-14" tabindex="-1"></a>  <span class="fu">return</span>(lhs <span class="sc">-</span> rhs)</span>
<span id="cb99-15"><a href="#cb99-15" tabindex="-1"></a>}</span>
<span id="cb99-16"><a href="#cb99-16" tabindex="-1"></a>solve_eq <span class="ot">&lt;-</span> <span class="cf">function</span>(k) {</span>
<span id="cb99-17"><a href="#cb99-17" tabindex="-1"></a>  f <span class="ot">&lt;-</span> <span class="cf">function</span>(a){<span class="fu">return</span>(<span class="fu">define_equation</span>(k, a))}</span>
<span id="cb99-18"><a href="#cb99-18" tabindex="-1"></a>  eps <span class="ot">&lt;-</span> <span class="fl">1e-2</span></span>
<span id="cb99-19"><a href="#cb99-19" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">f</span>(eps) <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">&amp;&amp;</span> <span class="fu">f</span>(<span class="fu">sqrt</span>(k) <span class="sc">-</span> eps) <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">||</span> <span class="fu">f</span>(eps) <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;&amp;</span> <span class="fu">f</span>(<span class="fu">sqrt</span>(k) <span class="sc">-</span> eps) <span class="sc">&lt;</span> <span class="dv">0</span>) {</span>
<span id="cb99-20"><a href="#cb99-20" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">uniroot</span>(f, <span class="at">interval =</span> <span class="fu">c</span>(eps, <span class="fu">sqrt</span>(k) <span class="sc">-</span> eps))<span class="sc">$</span>root)</span>
<span id="cb99-21"><a href="#cb99-21" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb99-22"><a href="#cb99-22" tabindex="-1"></a>    <span class="fu">return</span>(<span class="cn">NA</span>)</span>
<span id="cb99-23"><a href="#cb99-23" tabindex="-1"></a>  }</span>
<span id="cb99-24"><a href="#cb99-24" tabindex="-1"></a>}</span>
<span id="cb99-25"><a href="#cb99-25" tabindex="-1"></a>r11<span class="fl">.5</span> <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="fu">c</span>(<span class="dv">4</span><span class="sc">:</span><span class="dv">25</span>, <span class="dv">100</span>, <span class="dv">500</span>, <span class="dv">1000</span>), <span class="cf">function</span>(k) {</span>
<span id="cb99-26"><a href="#cb99-26" tabindex="-1"></a>  <span class="fu">solve_eq</span>(k) <span class="sc">%&gt;%</span> </span>
<span id="cb99-27"><a href="#cb99-27" tabindex="-1"></a>    <span class="fu">return</span>()</span>
<span id="cb99-28"><a href="#cb99-28" tabindex="-1"></a>})</span>
<span id="cb99-29"><a href="#cb99-29" tabindex="-1"></a>r11<span class="fl">.5</span></span></code></pre></div>
<pre><code>##  [1] 1.492073 1.533555 1.562745 1.584429 1.601184 1.614516 1.625389 1.634418
##  [9] 1.642026 1.648552 1.654175 1.659099 1.663454 1.667287       NA 1.673832
## [17] 1.676605 1.679148 1.681468 1.683593 1.685546 1.687366       NA       NA
## [25] 1.730903</code></pre>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" tabindex="-1"></a><span class="co">#  11.4</span></span>
<span id="cb101-2"><a href="#cb101-2" tabindex="-1"></a>findIntersection <span class="ot">=</span> <span class="cf">function</span> (k) {</span>
<span id="cb101-3"><a href="#cb101-3" tabindex="-1"></a>  s_k.minus.one <span class="ot">=</span> <span class="cf">function</span> (a) {<span class="dv">1</span> <span class="sc">-</span> <span class="fu">pt</span>(<span class="fu">sqrt</span>(a <span class="sc">^</span> <span class="dv">2</span> <span class="sc">*</span> (k <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">/</span> (k <span class="sc">-</span> a <span class="sc">^</span> <span class="dv">2</span>)), <span class="at">df =</span> k <span class="sc">-</span> <span class="dv">1</span>)}</span>
<span id="cb101-4"><a href="#cb101-4" tabindex="-1"></a>  s_k <span class="ot">=</span> <span class="cf">function</span> (a) {<span class="dv">1</span> <span class="sc">-</span> <span class="fu">pt</span>(<span class="fu">sqrt</span>(a <span class="sc">^</span> <span class="dv">2</span> <span class="sc">*</span> k <span class="sc">/</span> (k <span class="sc">+</span> <span class="dv">1</span> <span class="sc">-</span> a <span class="sc">^</span> <span class="dv">2</span>)), <span class="at">df =</span> k)}</span>
<span id="cb101-5"><a href="#cb101-5" tabindex="-1"></a>  f <span class="ot">=</span> <span class="cf">function</span> (a) {<span class="fu">s_k</span>(a) <span class="sc">-</span> <span class="fu">s_k.minus.one</span>(a)}</span>
<span id="cb101-6"><a href="#cb101-6" tabindex="-1"></a>  </span>
<span id="cb101-7"><a href="#cb101-7" tabindex="-1"></a>  eps <span class="ot">=</span> <span class="fl">1e-2</span></span>
<span id="cb101-8"><a href="#cb101-8" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">uniroot</span>(f, <span class="at">interval =</span> <span class="fu">c</span>(eps, <span class="fu">sqrt</span>(k) <span class="sc">-</span> eps))<span class="sc">$</span>root)</span>
<span id="cb101-9"><a href="#cb101-9" tabindex="-1"></a>}</span>
<span id="cb101-10"><a href="#cb101-10" tabindex="-1"></a></span>
<span id="cb101-11"><a href="#cb101-11" tabindex="-1"></a>r11<span class="fl">.4</span> <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="fu">c</span>(<span class="dv">4</span><span class="sc">:</span><span class="dv">25</span>, <span class="dv">100</span>, <span class="dv">500</span>, <span class="dv">1000</span>), <span class="cf">function</span> (k) {</span>
<span id="cb101-12"><a href="#cb101-12" tabindex="-1"></a>  <span class="fu">findIntersection</span>(k)</span>
<span id="cb101-13"><a href="#cb101-13" tabindex="-1"></a>})</span>
<span id="cb101-14"><a href="#cb101-14" tabindex="-1"></a></span>
<span id="cb101-15"><a href="#cb101-15" tabindex="-1"></a>r11<span class="fl">.4</span></span></code></pre></div>
<pre><code>##  [1]  1.492073  1.533555  1.562745  1.584429  1.601184  1.614516  1.625389
##  [8]  1.634418  1.642026  1.648552  1.654175  1.659099  1.663454  1.667287
## [15]  1.670733  1.673832  1.676605  1.679148  1.681468  4.785832  4.888979
## [22]  4.990000  9.990000 22.350680 31.612777</code></pre>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" tabindex="-1"></a><span class="do">##发现在k较小时二者都有非常相近的估计，但11.4相对更稳健。k很大时，EX11.5解的估计相对较差</span></span></code></pre></div>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" tabindex="-1"></a><span class="do">##</span></span>
<span id="cb104-2"><a href="#cb104-2" tabindex="-1"></a></span>
<span id="cb104-3"><a href="#cb104-3" tabindex="-1"></a><span class="co"># 定义观测数据</span></span>
<span id="cb104-4"><a href="#cb104-4" tabindex="-1"></a>observed_data <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.54</span>, <span class="fl">0.48</span>, <span class="fl">0.33</span>, <span class="fl">0.43</span>, <span class="fl">1.00</span>, <span class="fl">1.00</span>, <span class="fl">0.91</span>, <span class="fl">1.00</span>, <span class="fl">0.21</span>, <span class="fl">0.85</span>)</span>
<span id="cb104-5"><a href="#cb104-5" tabindex="-1"></a>tau <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb104-6"><a href="#cb104-6" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(observed_data)</span>
<span id="cb104-7"><a href="#cb104-7" tabindex="-1"></a></span>
<span id="cb104-8"><a href="#cb104-8" tabindex="-1"></a><span class="co"># 初始化参数</span></span>
<span id="cb104-9"><a href="#cb104-9" tabindex="-1"></a>lambda_init <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb104-10"><a href="#cb104-10" tabindex="-1"></a></span>
<span id="cb104-11"><a href="#cb104-11" tabindex="-1"></a><span class="co"># E-step: 计算E[Zi | Yi, λ]</span></span>
<span id="cb104-12"><a href="#cb104-12" tabindex="-1"></a>e_step <span class="ot">&lt;-</span> <span class="cf">function</span>(lambda, data, tau) {</span>
<span id="cb104-13"><a href="#cb104-13" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">pexp</span>(data, <span class="at">rate =</span> lambda))</span>
<span id="cb104-14"><a href="#cb104-14" tabindex="-1"></a>}</span>
<span id="cb104-15"><a href="#cb104-15" tabindex="-1"></a></span>
<span id="cb104-16"><a href="#cb104-16" tabindex="-1"></a><span class="co"># M-step: 更新λ</span></span>
<span id="cb104-17"><a href="#cb104-17" tabindex="-1"></a>m_step <span class="ot">&lt;-</span> <span class="cf">function</span>(lambda, data, tau) {</span>
<span id="cb104-18"><a href="#cb104-18" tabindex="-1"></a>  weights <span class="ot">&lt;-</span> <span class="fu">e_step</span>(lambda, data, tau)</span>
<span id="cb104-19"><a href="#cb104-19" tabindex="-1"></a>  weighted_sum <span class="ot">&lt;-</span> <span class="fu">sum</span>(weights <span class="sc">*</span> data)</span>
<span id="cb104-20"><a href="#cb104-20" tabindex="-1"></a>  total_weight <span class="ot">&lt;-</span> <span class="fu">sum</span>(weights)</span>
<span id="cb104-21"><a href="#cb104-21" tabindex="-1"></a>  new_lambda <span class="ot">&lt;-</span> total_weight <span class="sc">/</span> weighted_sum</span>
<span id="cb104-22"><a href="#cb104-22" tabindex="-1"></a>  <span class="fu">return</span>(new_lambda)</span>
<span id="cb104-23"><a href="#cb104-23" tabindex="-1"></a>}</span>
<span id="cb104-24"><a href="#cb104-24" tabindex="-1"></a></span>
<span id="cb104-25"><a href="#cb104-25" tabindex="-1"></a><span class="co"># E-M算法迭代</span></span>
<span id="cb104-26"><a href="#cb104-26" tabindex="-1"></a>em_algorithm <span class="ot">&lt;-</span> <span class="cf">function</span>(lambda_init, data, tau, <span class="at">tol =</span> <span class="fl">1e-6</span>, <span class="at">max_iter =</span> <span class="dv">100</span>) {</span>
<span id="cb104-27"><a href="#cb104-27" tabindex="-1"></a>  lambda <span class="ot">&lt;-</span> lambda_init</span>
<span id="cb104-28"><a href="#cb104-28" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>max_iter) {</span>
<span id="cb104-29"><a href="#cb104-29" tabindex="-1"></a>    new_lambda <span class="ot">&lt;-</span> <span class="fu">m_step</span>(lambda, data, tau)</span>
<span id="cb104-30"><a href="#cb104-30" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">abs</span>(new_lambda <span class="sc">-</span> lambda) <span class="sc">&lt;</span> tol) {</span>
<span id="cb104-31"><a href="#cb104-31" tabindex="-1"></a>      <span class="cf">break</span></span>
<span id="cb104-32"><a href="#cb104-32" tabindex="-1"></a>    }</span>
<span id="cb104-33"><a href="#cb104-33" tabindex="-1"></a>    lambda <span class="ot">&lt;-</span> new_lambda</span>
<span id="cb104-34"><a href="#cb104-34" tabindex="-1"></a>  }</span>
<span id="cb104-35"><a href="#cb104-35" tabindex="-1"></a>  <span class="fu">return</span>(lambda)</span>
<span id="cb104-36"><a href="#cb104-36" tabindex="-1"></a>}</span>
<span id="cb104-37"><a href="#cb104-37" tabindex="-1"></a></span>
<span id="cb104-38"><a href="#cb104-38" tabindex="-1"></a><span class="co"># 运行E-M算法</span></span>
<span id="cb104-39"><a href="#cb104-39" tabindex="-1"></a>estimated_lambda <span class="ot">&lt;-</span> <span class="fu">em_algorithm</span>(lambda_init, observed_data, tau)</span>
<span id="cb104-40"><a href="#cb104-40" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Estimated λ using E-M algorithm:&quot;</span>, estimated_lambda, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Estimated λ using E-M algorithm: 1.308579</code></pre>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" tabindex="-1"></a><span class="co"># 计算MLE</span></span>
<span id="cb106-2"><a href="#cb106-2" tabindex="-1"></a>mle_lambda <span class="ot">&lt;-</span> <span class="cf">function</span>(data, tau) {</span>
<span id="cb106-3"><a href="#cb106-3" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(data)</span>
<span id="cb106-4"><a href="#cb106-4" tabindex="-1"></a>  <span class="fu">return</span>(n <span class="sc">/</span> <span class="fu">sum</span>(data))</span>
<span id="cb106-5"><a href="#cb106-5" tabindex="-1"></a>}</span>
<span id="cb106-6"><a href="#cb106-6" tabindex="-1"></a></span>
<span id="cb106-7"><a href="#cb106-7" tabindex="-1"></a><span class="co"># 计算MLE</span></span>
<span id="cb106-8"><a href="#cb106-8" tabindex="-1"></a>mle_estimated_lambda <span class="ot">&lt;-</span> <span class="fu">mle_lambda</span>(observed_data, tau)</span>
<span id="cb106-9"><a href="#cb106-9" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Estimated λ using MLE:&quot;</span>, mle_estimated_lambda, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Estimated λ using MLE: 1.481481</code></pre>
<p>A-SA24204149-2024-11-11</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" tabindex="-1"></a><span class="do">##11.7</span></span>
<span id="cb108-2"><a href="#cb108-2" tabindex="-1"></a><span class="co"># 定义目标函数的系数(lpSolve默认是求最大化所以取个负号)</span></span>
<span id="cb108-3"><a href="#cb108-3" tabindex="-1"></a>objective <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="sc">-</span><span class="dv">2</span>, <span class="sc">-</span><span class="dv">9</span>)</span>
<span id="cb108-4"><a href="#cb108-4" tabindex="-1"></a><span class="co"># 引入s1，s2两个松弛变量，定义约束矩阵</span></span>
<span id="cb108-5"><a href="#cb108-5" tabindex="-1"></a>c <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, </span>
<span id="cb108-6"><a href="#cb108-6" tabindex="-1"></a>                        <span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">1</span>), </span>
<span id="cb108-7"><a href="#cb108-7" tabindex="-1"></a><span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb108-8"><a href="#cb108-8" tabindex="-1"></a><span class="co"># 定义约束的方向（&quot;&lt;=&quot;表示小于等于）</span></span>
<span id="cb108-9"><a href="#cb108-9" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;&lt;=&quot;</span>, <span class="st">&quot;&lt;=&quot;</span>)</span>
<span id="cb108-10"><a href="#cb108-10" tabindex="-1"></a><span class="co"># 定义约束的右侧值</span></span>
<span id="cb108-11"><a href="#cb108-11" tabindex="-1"></a>r<span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb108-12"><a href="#cb108-12" tabindex="-1"></a><span class="co"># 用lp函数求解</span></span>
<span id="cb108-13"><a href="#cb108-13" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">lp</span>(<span class="st">&quot;min&quot;</span>, objective, c, d, r)</span>
<span id="cb108-14"><a href="#cb108-14" tabindex="-1"></a><span class="co"># 输出结果</span></span>
<span id="cb108-15"><a href="#cb108-15" tabindex="-1"></a><span class="fu">print</span>(result<span class="sc">$</span>solution)</span></code></pre></div>
<pre><code>## [1] 0.5 0.0 0.0</code></pre>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" tabindex="-1"></a><span class="fu">print</span>(result<span class="sc">$</span>objval)</span></code></pre></div>
<pre><code>## [1] -2</code></pre>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" tabindex="-1"></a><span class="do">##最终结果再取个负号，所以结果为2</span></span></code></pre></div>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" tabindex="-1"></a><span class="do">##EX3</span></span>
<span id="cb113-2"><a href="#cb113-2" tabindex="-1"></a></span>
<span id="cb113-3"><a href="#cb113-3" tabindex="-1"></a><span class="co"># 定义公式列表</span></span>
<span id="cb113-4"><a href="#cb113-4" tabindex="-1"></a>formulas <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb113-5"><a href="#cb113-5" tabindex="-1"></a>  mpg <span class="sc">~</span> disp,</span>
<span id="cb113-6"><a href="#cb113-6" tabindex="-1"></a>  mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span> <span class="sc">/</span> disp),</span>
<span id="cb113-7"><a href="#cb113-7" tabindex="-1"></a>  mpg <span class="sc">~</span> disp <span class="sc">+</span> wt,</span>
<span id="cb113-8"><a href="#cb113-8" tabindex="-1"></a>  mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span> <span class="sc">/</span> disp) <span class="sc">+</span> wt</span>
<span id="cb113-9"><a href="#cb113-9" tabindex="-1"></a>)</span>
<span id="cb113-10"><a href="#cb113-10" tabindex="-1"></a><span class="co"># 用 for 循环拟合线性模型</span></span>
<span id="cb113-11"><a href="#cb113-11" tabindex="-1"></a>f<span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb113-12"><a href="#cb113-12" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(formulas)) {</span>
<span id="cb113-13"><a href="#cb113-13" tabindex="-1"></a>  f[[i]] <span class="ot">&lt;-</span> <span class="fu">lm</span>(formulas[[i]], <span class="at">data =</span> mtcars)</span>
<span id="cb113-14"><a href="#cb113-14" tabindex="-1"></a>}</span>
<span id="cb113-15"><a href="#cb113-15" tabindex="-1"></a><span class="fu">print</span>(f)</span></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" tabindex="-1"></a><span class="co">#使用 lapply() 拟合线性模型</span></span>
<span id="cb115-2"><a href="#cb115-2" tabindex="-1"></a>l <span class="ot">&lt;-</span> <span class="fu">lapply</span>(formulas, <span class="cf">function</span>(frm) <span class="fu">lm</span>(frm, <span class="at">data =</span> mtcars))</span>
<span id="cb115-3"><a href="#cb115-3" tabindex="-1"></a><span class="fu">print</span>(l)</span></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = frm, data = mtcars)
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = frm, data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = frm, data = mtcars)
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = frm, data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" tabindex="-1"></a><span class="do">##EX4</span></span>
<span id="cb117-2"><a href="#cb117-2" tabindex="-1"></a><span class="co"># 定义公式</span></span>
<span id="cb117-3"><a href="#cb117-3" tabindex="-1"></a>formula <span class="ot">&lt;-</span> mpg <span class="sc">~</span> disp</span>
<span id="cb117-4"><a href="#cb117-4" tabindex="-1"></a><span class="co"># 创建引导样本列表</span></span>
<span id="cb117-5"><a href="#cb117-5" tabindex="-1"></a>bootstraps <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="cf">function</span>(i) {</span>
<span id="cb117-6"><a href="#cb117-6" tabindex="-1"></a>  rows <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(mtcars), <span class="at">rep =</span> <span class="cn">TRUE</span>)</span>
<span id="cb117-7"><a href="#cb117-7" tabindex="-1"></a>  mtcars[rows, ]</span>
<span id="cb117-8"><a href="#cb117-8" tabindex="-1"></a>})</span>
<span id="cb117-9"><a href="#cb117-9" tabindex="-1"></a><span class="co"># 用 for 循环来拟合线性模型</span></span>
<span id="cb117-10"><a href="#cb117-10" tabindex="-1"></a>f<span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb117-11"><a href="#cb117-11" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(bootstraps)) {</span>
<span id="cb117-12"><a href="#cb117-12" tabindex="-1"></a>  f[[i]] <span class="ot">&lt;-</span> <span class="fu">lm</span>(formula, <span class="at">data =</span> bootstraps[[i]])</span>
<span id="cb117-13"><a href="#cb117-13" tabindex="-1"></a>}</span>
<span id="cb117-14"><a href="#cb117-14" tabindex="-1"></a><span class="fu">print</span>(f)</span></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = formula, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.91850     -0.03966  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = formula, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##     31.3828      -0.0481  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = formula, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    28.76243     -0.04099  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = formula, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##      29.838       -0.045  
## 
## 
## [[5]]
## 
## Call:
## lm(formula = formula, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    30.42831     -0.04673  
## 
## 
## [[6]]
## 
## Call:
## lm(formula = formula, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    27.81532     -0.03468  
## 
## 
## [[7]]
## 
## Call:
## lm(formula = formula, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.84376     -0.04344  
## 
## 
## [[8]]
## 
## Call:
## lm(formula = formula, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##     29.1599      -0.0421  
## 
## 
## [[9]]
## 
## Call:
## lm(formula = formula, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    28.82229     -0.03991  
## 
## 
## [[10]]
## 
## Call:
## lm(formula = formula, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    31.44171     -0.04578</code></pre>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" tabindex="-1"></a><span class="co"># 用 lapply() 来拟合线性模型</span></span>
<span id="cb119-2"><a href="#cb119-2" tabindex="-1"></a>l <span class="ot">&lt;-</span> <span class="fu">lapply</span>(bootstraps, <span class="cf">function</span>(data) <span class="fu">lm</span>(formula, <span class="at">data =</span> data))</span>
<span id="cb119-3"><a href="#cb119-3" tabindex="-1"></a><span class="fu">print</span>(l)</span></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = formula, data = data)
## 
## Coefficients:
## (Intercept)         disp  
##    29.91850     -0.03966  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = formula, data = data)
## 
## Coefficients:
## (Intercept)         disp  
##     31.3828      -0.0481  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = formula, data = data)
## 
## Coefficients:
## (Intercept)         disp  
##    28.76243     -0.04099  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = formula, data = data)
## 
## Coefficients:
## (Intercept)         disp  
##      29.838       -0.045  
## 
## 
## [[5]]
## 
## Call:
## lm(formula = formula, data = data)
## 
## Coefficients:
## (Intercept)         disp  
##    30.42831     -0.04673  
## 
## 
## [[6]]
## 
## Call:
## lm(formula = formula, data = data)
## 
## Coefficients:
## (Intercept)         disp  
##    27.81532     -0.03468  
## 
## 
## [[7]]
## 
## Call:
## lm(formula = formula, data = data)
## 
## Coefficients:
## (Intercept)         disp  
##    29.84376     -0.04344  
## 
## 
## [[8]]
## 
## Call:
## lm(formula = formula, data = data)
## 
## Coefficients:
## (Intercept)         disp  
##     29.1599      -0.0421  
## 
## 
## [[9]]
## 
## Call:
## lm(formula = formula, data = data)
## 
## Coefficients:
## (Intercept)         disp  
##    28.82229     -0.03991  
## 
## 
## [[10]]
## 
## Call:
## lm(formula = formula, data = data)
## 
## Coefficients:
## (Intercept)         disp  
##    31.44171     -0.04578</code></pre>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" tabindex="-1"></a><span class="do">##EX5</span></span>
<span id="cb121-2"><a href="#cb121-2" tabindex="-1"></a><span class="do">##对前两问得到的结果取个summary$r.squared，再用sapply对每个结果提取即可</span></span></code></pre></div>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" tabindex="-1"></a><span class="do">##EX3</span></span>
<span id="cb122-2"><a href="#cb122-2" tabindex="-1"></a><span class="co"># 模拟 t-test 的性能</span></span>
<span id="cb122-3"><a href="#cb122-3" tabindex="-1"></a>trials <span class="ot">&lt;-</span> <span class="fu">replicate</span>(</span>
<span id="cb122-4"><a href="#cb122-4" tabindex="-1"></a>  <span class="dv">5</span>,</span>
<span id="cb122-5"><a href="#cb122-5" tabindex="-1"></a>  <span class="fu">t.test</span>(<span class="fu">rpois</span>(<span class="dv">9</span>, <span class="dv">9</span>), <span class="fu">rpois</span>(<span class="dv">6</span>, <span class="dv">9</span>)),</span>
<span id="cb122-6"><a href="#cb122-6" tabindex="-1"></a>  <span class="at">simplify =</span> <span class="cn">FALSE</span></span>
<span id="cb122-7"><a href="#cb122-7" tabindex="-1"></a>)</span>
<span id="cb122-8"><a href="#cb122-8" tabindex="-1"></a><span class="co"># 匿名函数提取 p-value</span></span>
<span id="cb122-9"><a href="#cb122-9" tabindex="-1"></a>p_values1 <span class="ot">&lt;-</span> <span class="fu">sapply</span>(trials, <span class="cf">function</span>(trial) trial<span class="sc">$</span>p.value)</span>
<span id="cb122-10"><a href="#cb122-10" tabindex="-1"></a><span class="fu">print</span>(p_values1)</span></code></pre></div>
<pre><code>## [1] 0.3740891 0.7634563 0.6611149 0.6758247 0.3268294</code></pre>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" tabindex="-1"></a><span class="co">#  [[ 提取 p-value</span></span>
<span id="cb124-2"><a href="#cb124-2" tabindex="-1"></a>p_values2 <span class="ot">&lt;-</span> <span class="fu">sapply</span>(trials, <span class="st">&quot;[[&quot;</span>, <span class="st">&quot;p.value&quot;</span>)</span>
<span id="cb124-3"><a href="#cb124-3" tabindex="-1"></a><span class="fu">print</span>(p_values2)</span></code></pre></div>
<pre><code>## [1] 0.3740891 0.7634563 0.6611149 0.6758247 0.3268294</code></pre>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" tabindex="-1"></a><span class="co"># 定义一个并行版本的 lapply 函数</span></span>
<span id="cb126-2"><a href="#cb126-2" tabindex="-1"></a>parallel_lapply <span class="ot">&lt;-</span> <span class="cf">function</span>(X, FUN, ...) {</span>
<span id="cb126-3"><a href="#cb126-3" tabindex="-1"></a>  <span class="co"># 获取可用的核心数</span></span>
<span id="cb126-4"><a href="#cb126-4" tabindex="-1"></a>  num_cores <span class="ot">&lt;-</span> <span class="fu">detectCores</span>() <span class="sc">-</span> <span class="dv">7</span></span>
<span id="cb126-5"><a href="#cb126-5" tabindex="-1"></a>  </span>
<span id="cb126-6"><a href="#cb126-6" tabindex="-1"></a>  <span class="co"># 使用 mclapply 进行并行计算</span></span>
<span id="cb126-7"><a href="#cb126-7" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="fu">mclapply</span>(X, FUN, ..., <span class="at">mc.cores =</span> num_cores)</span>
<span id="cb126-8"><a href="#cb126-8" tabindex="-1"></a>  </span>
<span id="cb126-9"><a href="#cb126-9" tabindex="-1"></a>  <span class="fu">return</span>(result)</span>
<span id="cb126-10"><a href="#cb126-10" tabindex="-1"></a>}</span>
<span id="cb126-11"><a href="#cb126-11" tabindex="-1"></a></span>
<span id="cb126-12"><a href="#cb126-12" tabindex="-1"></a><span class="co"># 示例用法</span></span>
<span id="cb126-13"><a href="#cb126-13" tabindex="-1"></a>input_vector <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span></span>
<span id="cb126-14"><a href="#cb126-14" tabindex="-1"></a>square_function <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb126-15"><a href="#cb126-15" tabindex="-1"></a>  <span class="fu">Sys.sleep</span>(<span class="dv">1</span>)  <span class="co"># 模拟耗时操作</span></span>
<span id="cb126-16"><a href="#cb126-16" tabindex="-1"></a>  <span class="fu">return</span>(x<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb126-17"><a href="#cb126-17" tabindex="-1"></a>}</span>
<span id="cb126-18"><a href="#cb126-18" tabindex="-1"></a></span>
<span id="cb126-19"><a href="#cb126-19" tabindex="-1"></a><span class="co"># 调用并行版本的 lapply</span></span>
<span id="cb126-20"><a href="#cb126-20" tabindex="-1"></a>output_vector <span class="ot">&lt;-</span> <span class="fu">parallel_lapply</span>(input_vector, square_function)</span>
<span id="cb126-21"><a href="#cb126-21" tabindex="-1"></a><span class="fu">print</span>(output_vector)</span></code></pre></div>
<pre><code>## [[1]]
## [1] 1
## 
## [[2]]
## [1] 4
## 
## [[3]]
## [1] 9
## 
## [[4]]
## [1] 16
## 
## [[5]]
## [1] 25
## 
## [[6]]
## [1] 36
## 
## [[7]]
## [1] 49
## 
## [[8]]
## [1] 64
## 
## [[9]]
## [1] 81
## 
## [[10]]
## [1] 100</code></pre>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" tabindex="-1"></a><span class="do">##EX4</span></span>
<span id="cb128-2"><a href="#cb128-2" tabindex="-1"></a>fast <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb128-3"><a href="#cb128-3" tabindex="-1"></a>  table_xy <span class="ot">&lt;-</span> <span class="fu">table</span>(x, y)</span>
<span id="cb128-4"><a href="#cb128-4" tabindex="-1"></a>  observed <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(table_xy)</span>
<span id="cb128-5"><a href="#cb128-5" tabindex="-1"></a>  row_sums <span class="ot">&lt;-</span> <span class="fu">colSums</span>(table_xy)</span>
<span id="cb128-6"><a href="#cb128-6" tabindex="-1"></a>  col_sums <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(table_xy)</span>
<span id="cb128-7"><a href="#cb128-7" tabindex="-1"></a>  total_sum <span class="ot">&lt;-</span> <span class="fu">sum</span>(observed)</span>
<span id="cb128-8"><a href="#cb128-8" tabindex="-1"></a>  expected <span class="ot">&lt;-</span> <span class="fu">outer</span>(row_sums, col_sums, <span class="st">&quot;*&quot;</span>) <span class="sc">/</span> total_sum</span>
<span id="cb128-9"><a href="#cb128-9" tabindex="-1"></a>  chisq <span class="ot">&lt;-</span> <span class="fu">sum</span>((observed <span class="sc">-</span> expected)<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> expected)</span>
<span id="cb128-10"><a href="#cb128-10" tabindex="-1"></a>  <span class="fu">return</span>(chisq)</span>
<span id="cb128-11"><a href="#cb128-11" tabindex="-1"></a>}</span>
<span id="cb128-12"><a href="#cb128-12" tabindex="-1"></a></span>
<span id="cb128-13"><a href="#cb128-13" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>)</span>
<span id="cb128-14"><a href="#cb128-14" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>)</span>
<span id="cb128-15"><a href="#cb128-15" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">fast</span>(x, y)</span>
<span id="cb128-16"><a href="#cb128-16" tabindex="-1"></a><span class="fu">print</span>(result)</span></code></pre></div>
<pre><code>## [1] 20</code></pre>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" tabindex="-1"></a><span class="do">##ex5</span></span>
<span id="cb130-2"><a href="#cb130-2" tabindex="-1"></a>fast <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb130-3"><a href="#cb130-3" tabindex="-1"></a>  <span class="co"># 获取唯一值及其索引</span></span>
<span id="cb130-4"><a href="#cb130-4" tabindex="-1"></a>  x_levels <span class="ot">&lt;-</span> <span class="fu">unique</span>(x)</span>
<span id="cb130-5"><a href="#cb130-5" tabindex="-1"></a>  y_levels <span class="ot">&lt;-</span> <span class="fu">unique</span>(y)</span>
<span id="cb130-6"><a href="#cb130-6" tabindex="-1"></a>  </span>
<span id="cb130-7"><a href="#cb130-7" tabindex="-1"></a>  <span class="co"># 创建结果矩阵</span></span>
<span id="cb130-8"><a href="#cb130-8" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">length</span>(x_levels), <span class="at">ncol =</span> <span class="fu">length</span>(y_levels))</span>
<span id="cb130-9"><a href="#cb130-9" tabindex="-1"></a>  <span class="fu">rownames</span>(result) <span class="ot">&lt;-</span> <span class="fu">as.character</span>(x_levels)</span>
<span id="cb130-10"><a href="#cb130-10" tabindex="-1"></a>  <span class="fu">colnames</span>(result) <span class="ot">&lt;-</span> <span class="fu">as.character</span>(y_levels)</span>
<span id="cb130-11"><a href="#cb130-11" tabindex="-1"></a>  </span>
<span id="cb130-12"><a href="#cb130-12" tabindex="-1"></a>  <span class="co"># 填充结果矩阵</span></span>
<span id="cb130-13"><a href="#cb130-13" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(x)) {</span>
<span id="cb130-14"><a href="#cb130-14" tabindex="-1"></a>    result[<span class="fu">as.character</span>(x[i]), <span class="fu">as.character</span>(y[i])] <span class="ot">&lt;-</span> result[<span class="fu">as.character</span>(x[i]), <span class="fu">as.character</span>(y[i])] <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb130-15"><a href="#cb130-15" tabindex="-1"></a>  }</span>
<span id="cb130-16"><a href="#cb130-16" tabindex="-1"></a>  <span class="fu">return</span>(result)</span>
<span id="cb130-17"><a href="#cb130-17" tabindex="-1"></a>}</span>
<span id="cb130-18"><a href="#cb130-18" tabindex="-1"></a><span class="co"># 示例用法</span></span>
<span id="cb130-19"><a href="#cb130-19" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb130-20"><a href="#cb130-20" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">1</span>)</span>
<span id="cb130-21"><a href="#cb130-21" tabindex="-1"></a><span class="co"># 使用自定义的fast_table函数</span></span>
<span id="cb130-22"><a href="#cb130-22" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">fast</span>(x, y)</span>
<span id="cb130-23"><a href="#cb130-23" tabindex="-1"></a><span class="fu">print</span>(result)</span></code></pre></div>
<pre><code>##   3 2 1
## 1 3 0 0
## 2 0 3 0
## 3 0 0 3</code></pre>
<p>A-SA24204149-2024-11-18</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" tabindex="-1"></a><span class="co"># Number of samples to generate</span></span>
<span id="cb132-2"><a href="#cb132-2" tabindex="-1"></a>n_samples <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb132-3"><a href="#cb132-3" tabindex="-1"></a></span>
<span id="cb132-4"><a href="#cb132-4" tabindex="-1"></a><span class="co"># Parameters for the Gibbs sampler</span></span>
<span id="cb132-5"><a href="#cb132-5" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb132-6"><a href="#cb132-6" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb132-7"><a href="#cb132-7" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb132-8"><a href="#cb132-8" tabindex="-1"></a></span>
<span id="cb132-9"><a href="#cb132-9" tabindex="-1"></a><span class="co"># Call the C++ function to generate the samples</span></span>
<span id="cb132-10"><a href="#cb132-10" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">Gibbs</span>(n_samples, n, a, b)</span>
<span id="cb132-11"><a href="#cb132-11" tabindex="-1"></a></span>
<span id="cb132-12"><a href="#cb132-12" tabindex="-1"></a><span class="co"># Extract the samples</span></span>
<span id="cb132-13"><a href="#cb132-13" tabindex="-1"></a>x_samples <span class="ot">&lt;-</span> result<span class="sc">$</span>x</span>
<span id="cb132-14"><a href="#cb132-14" tabindex="-1"></a>y_samples <span class="ot">&lt;-</span> result<span class="sc">$</span>y</span>
<span id="cb132-15"><a href="#cb132-15" tabindex="-1"></a><span class="fu">head</span>(x_samples)</span></code></pre></div>
<pre><code>## [1] 6 4 1 0 4 3</code></pre>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" tabindex="-1"></a><span class="fu">head</span>(y_samples)</span></code></pre></div>
<pre><code>## [1] 0.5405658 0.3707393 0.3589223 0.3432836 0.4213238 0.2157910</code></pre>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb136-2"><a href="#cb136-2" tabindex="-1"></a></span>
<span id="cb136-3"><a href="#cb136-3" tabindex="-1"></a><span class="do">## 使用R自带函数生成随机数</span></span>
<span id="cb136-4"><a href="#cb136-4" tabindex="-1"></a>Gibbs_R <span class="ot">&lt;-</span> <span class="cf">function</span>(n, a, b, n_samples) {</span>
<span id="cb136-5"><a href="#cb136-5" tabindex="-1"></a>  x_samples_r <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_samples)</span>
<span id="cb136-6"><a href="#cb136-6" tabindex="-1"></a>  y_samples_r <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_samples)</span>
<span id="cb136-7"><a href="#cb136-7" tabindex="-1"></a></span>
<span id="cb136-8"><a href="#cb136-8" tabindex="-1"></a>  <span class="co"># 初始化y</span></span>
<span id="cb136-9"><a href="#cb136-9" tabindex="-1"></a>  y_temp <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb136-10"><a href="#cb136-10" tabindex="-1"></a></span>
<span id="cb136-11"><a href="#cb136-11" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_samples) {</span>
<span id="cb136-12"><a href="#cb136-12" tabindex="-1"></a>    x_samples_r[i] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, n, y_temp)</span>
<span id="cb136-13"><a href="#cb136-13" tabindex="-1"></a>    y_temp <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>, x_samples_r[i] <span class="sc">+</span> a, n <span class="sc">-</span> x_samples_r[i] <span class="sc">+</span> b)</span>
<span id="cb136-14"><a href="#cb136-14" tabindex="-1"></a>    y_samples_r[i] <span class="ot">&lt;-</span> y_temp</span>
<span id="cb136-15"><a href="#cb136-15" tabindex="-1"></a>  }</span>
<span id="cb136-16"><a href="#cb136-16" tabindex="-1"></a></span>
<span id="cb136-17"><a href="#cb136-17" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">x_samples =</span> x_samples_r, <span class="at">y_samples =</span> y_samples_r))</span>
<span id="cb136-18"><a href="#cb136-18" tabindex="-1"></a>}</span>
<span id="cb136-19"><a href="#cb136-19" tabindex="-1"></a></span>
<span id="cb136-20"><a href="#cb136-20" tabindex="-1"></a><span class="do">## 调用Gibbs_R生成随机数</span></span>
<span id="cb136-21"><a href="#cb136-21" tabindex="-1"></a>result_R <span class="ot">&lt;-</span> <span class="fu">Gibbs_R</span>(n, a, b, n_samples)</span>
<span id="cb136-22"><a href="#cb136-22" tabindex="-1"></a>x_r_samples <span class="ot">&lt;-</span> result_R<span class="sc">$</span>x_samples</span>
<span id="cb136-23"><a href="#cb136-23" tabindex="-1"></a>y_r_samples <span class="ot">&lt;-</span> result_R<span class="sc">$</span>y_samples</span>
<span id="cb136-24"><a href="#cb136-24" tabindex="-1"></a>x_r_samples</span></code></pre></div>
<pre><code>##    [1]  4  6  6  2  3  1  2  5  5  7  5  3  1  1  0  0  3  5  4  5  2  5  6  5
##   [25]  4  2  4  5  4  3  1  2  4  6  3  8  6  4  2  1  1  3  5  3  3  2  0  2
##   [49]  2  1  0  2  2  3  1  2  3  6  6  4  7  3  4  3  5  3  1  0  2  3  4  5
##   [73]  7  7  5  3  4  3  3  4  6  3  3  3  3  7  7  7  9 10  8  9  8  4  5  3
##   [97]  3  4  6  4  4  7  7  5  6  5  2  6  5  5  6  5  5  3  3  5  6  6  6  9
##  [121]  9  8  9  6  8  8  5  6  9  7  6  8  2  0  0  1  1  2  3  1  1  2  2  0
##  [145]  4  5  4  6  6  3  2  2  3  2  1  3  2  1  3  3  1  0  3  5  2  2  1  2
##  [169]  3  1  1  2  7  3  1  4  6  3  4  7  6  3  2  1  5  5  6  3  6  9  7  5
##  [193]  7  5  6  6  7  5  7  4  5  2  0  0  1  3  4  3  2  0  0  0  0  0  4  3
##  [217]  3  4  0  2  6  5  3  2  5  8  8  6  5  2  1  0  0  2  1  5  5  2  4  0
##  [241]  2  1  2  2  1  1  2  4  5  5  1  3  6  4  3  4  5  7  7  4  0  4  5  9
##  [265]  8  6  8  8  8  2  4  6  2  2  4  8  6  5  5  4  0  1  1  3  4  2  3  7
##  [289]  6  7  6  8  8  4  4  4  3  6  7  6  6  2  3  4  7  9  9  7  8  9  8  9
##  [313]  8  7  6  4  3  1  1  1  2  4  2  4  5  6  5  6  5  8  5  6  2  2  1  1
##  [337]  0  1  1  2  5  6  6  6  4  2  1  2  3  4  5  4  3  3  2  6  3  1  0  0
##  [361]  0  1  5  8  7  4  4  3  5  3  5  5  9  7  5  3  6  5  1  0  1  0  0  3
##  [385]  0  1  0  0  2  1  2  0  2  3  4  5  4  5  6  5  5  2  4  3  1  4  1  3
##  [409]  2  0  1  2  2  3  2  2  4  0  0  0  0  2  2  1  1  2  5  6  5  6  4  4
##  [433]  3  0  2  1  2  4  4  4  5  5  5  5  6  9  6  8  7  5  5  3  3  6  8  6
##  [457]  9  5  4  7  5  5  4  7  7  6  8  5  4  5  1  1  2  4  2  8  5  8  4  7
##  [481]  7  6  7  8  6  5  5  1  0  1  2  4  6  6  8  7  2  5  6  2  2  0  0  1
##  [505]  2  4  7  9  5  6  2  1  2  0  0  5  3  1  3  4  3  3  6  6  5  6  5  8
##  [529]  6  8  7  3  1  0  3  7  4  7  7  8  6  7  6  5  2  4  5  7  6  6  6  3
##  [553]  4  3  4  5  6  6  5  5  6  5  6  8  6  6  7  3  4  4  2  3  3  4  6  6
##  [577]  4  2  4  6  8  9  7  7  5  2  2  2  4  2  3  2  2  7  7  6  2  0  1  1
##  [601]  2  0  1  0  1  2  1  1  4  5  6  4  3  4  3  5  5  3  2  1  0  0  1  2
##  [625]  1  1  3  4  4  7  6  3  2  5  2  4  6  3  0  0  2  5  3  4  8  8 10  6
##  [649]  8  7  6  4  3  4  3  3  6  8  8  4  3  1  0  1  0  0  0  2  2  3  2  3
##  [673]  4  6  5  5  5  6  1  0  1  1  0  0  1  7  9  4  5  6  3  1  5  9  7  8
##  [697]  3  2  4  2  0  1  1  2  5  5  5  5  6  5  6  6  6  8  6  6  8 10  8  8
##  [721]  3  2  2  3  2  0  2  2  2  5  4  6  3  6  7  7  9  6  3  3  3  6  1  3
##  [745]  2  2  2  1  3  0  3  2  2  1  2  3  2  4  2  0  0  0  0  2  1  3  5  5
##  [769]  5  6  6  5  6  2  1  3  3  6  4  4  4  6  6  5  4  3  1  3  2  2  4  1
##  [793]  2  2  0  0  1  5  6  5  8  8  6  7  3  4  3  2  4  6  6  3  0  1  0  1
##  [817]  3  5  2  0  1  2  3  1  0  0  3  5  6  9  8  7  5  5  7  8  4  8  6  2
##  [841]  2  6  4  4  0  0  0  0  3  5  3  5  4  1  3  3  3  3  6  6  5  2  1  2
##  [865]  7  5  8  7  5  4  2  4  6  5  7  5  6  4  1  3  5  8  6  1  0  0  2  2
##  [889]  4  4  3  0  1  4  3  7  5  4  4  4  5  5  5  6  9  6  6  8  7  9  7  3
##  [913]  4  6  7  3  1  2  1  5  2  5  5  6  8  5  3  2  3  2  1  2  1  0  2  3
##  [937]  2  3  3  3  2  2  3  8  4  6  7  6  4  4  5  4  1  4  2  3  1  2  4  4
##  [961]  2  2  2  3  6  6  8  7  6  8  6  7  3  4  3  3  3  3  0  0  1  1  2  3
##  [985]  6  4  3  2  3  7  6  4  2  2  4  2  3  5  5  4</code></pre>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" tabindex="-1"></a>y_r_samples</span></code></pre></div>
<pre><code>##    [1] 0.36746076 0.77682104 0.51448220 0.25150486 0.17655208 0.05320022
##    [7] 0.46722337 0.54776621 0.38631794 0.39515857 0.18534217 0.23212427
##   [13] 0.09602421 0.16208029 0.07057312 0.30865460 0.46166984 0.34835630
##   [19] 0.59769868 0.27699943 0.40447448 0.59941110 0.43107950 0.35511658
##   [25] 0.34661335 0.32817432 0.22878087 0.33157871 0.34352786 0.21992433
##   [31] 0.19002482 0.21331197 0.39387688 0.49293076 0.58697148 0.80149486
##   [37] 0.50177802 0.33456890 0.22493754 0.07690553 0.23975761 0.42800108
##   [43] 0.60493754 0.31252039 0.07783348 0.17964681 0.07333185 0.26585122
##   [49] 0.13133761 0.11926314 0.13396464 0.22658715 0.36135896 0.25148215
##   [55] 0.25888175 0.27664228 0.48867000 0.62409343 0.62408685 0.60441172
##   [61] 0.35301071 0.39291185 0.30173637 0.33857992 0.41637320 0.21294563
##   [67] 0.11907465 0.20307951 0.19704227 0.40447695 0.39207000 0.67691350
##   [73] 0.58476955 0.63679995 0.31857608 0.39419743 0.33151308 0.42294609
##   [79] 0.36682100 0.51983228 0.54368798 0.52333870 0.33907635 0.28093138
##   [85] 0.51347030 0.73377256 0.79381737 0.74898907 0.89919087 0.87809438
##   [91] 0.73666774 0.87238471 0.54677982 0.49131277 0.32085854 0.33065950
##   [97] 0.41660302 0.52982624 0.58752827 0.32528517 0.22945225 0.83847506
##  [103] 0.55646189 0.61243723 0.45708398 0.29629480 0.26220422 0.57441215
##  [109] 0.47216524 0.43700534 0.68710333 0.39420527 0.34155324 0.32750572
##  [115] 0.50956167 0.34954144 0.50199792 0.42380983 0.66276927 0.82770928
##  [121] 0.64575535 0.75856042 0.51471362 0.55163692 0.72186768 0.51716358
##  [127] 0.38072020 0.60026742 0.71732838 0.66462207 0.60794136 0.64406335
##  [133] 0.18092334 0.12981959 0.08144606 0.10350626 0.30263825 0.33040112
##  [139] 0.24180728 0.29568341 0.18921005 0.19315085 0.19714900 0.27591819
##  [145] 0.46170205 0.54616516 0.32992403 0.70636512 0.55929089 0.15422853
##  [151] 0.18720621 0.38692425 0.25944877 0.16013828 0.18941548 0.29759029
##  [157] 0.25196260 0.33673362 0.26850915 0.40127965 0.18424482 0.22187293
##  [163] 0.34582194 0.27423635 0.11568658 0.22988752 0.22219954 0.29664866
##  [169] 0.33676414 0.11454602 0.16946911 0.46259542 0.56790444 0.41464186
##  [175] 0.22130989 0.53584655 0.36000526 0.39603694 0.40958971 0.75942918
##  [181] 0.53028107 0.11640937 0.17776935 0.32740014 0.40344320 0.27852058
##  [187] 0.50236014 0.50873421 0.78200223 0.56906901 0.49406865 0.55722427
##  [193] 0.46037722 0.59177038 0.72692734 0.73138859 0.49721209 0.49133888
##  [199] 0.38801282 0.34614781 0.29478034 0.15182908 0.01512091 0.08144814
##  [205] 0.33092431 0.31549350 0.54750965 0.35121681 0.25987653 0.17594138
##  [211] 0.08160320 0.03920424 0.29590953 0.31348172 0.41682193 0.30894342
##  [217] 0.39307427 0.35860130 0.11240915 0.44969747 0.37904024 0.18118074
##  [223] 0.38802828 0.20786552 0.39999814 0.79844219 0.72820709 0.74772835
##  [229] 0.38146177 0.10980605 0.19826113 0.06417870 0.15556966 0.14638092
##  [235] 0.26508689 0.59982900 0.30242951 0.23686182 0.31026878 0.18341683
##  [241] 0.16971356 0.21334977 0.39566726 0.19639509 0.19117950 0.05606298
##  [247] 0.26288565 0.46389463 0.41605405 0.30991538 0.22922883 0.26820780
##  [253] 0.43646822 0.18552137 0.32056608 0.42631012 0.38639917 0.50537275
##  [259] 0.58177090 0.10379229 0.09098174 0.48467247 0.71817732 0.53332904
##  [265] 0.61193302 0.62155130 0.66399038 0.78816335 0.49500167 0.33902926
##  [271] 0.46715129 0.29090460 0.18934746 0.36984398 0.53499978 0.70746396
##  [277] 0.31445264 0.49749824 0.57297352 0.20352200 0.08822848 0.20978614
##  [283] 0.33207637 0.50145698 0.34520657 0.38573744 0.44541156 0.73674164
##  [289] 0.36321507 0.60350402 0.72464789 0.72099212 0.64528764 0.17411039
##  [295] 0.45474618 0.37353132 0.37841683 0.50779447 0.49258394 0.62216566
##  [301] 0.28289492 0.24058696 0.56492924 0.50501052 0.71999020 0.82295102
##  [307] 0.71104359 0.63884431 0.74553962 0.74057363 0.84964211 0.78410549
##  [313] 0.64551120 0.68135796 0.50174701 0.33408740 0.25265564 0.21357636
##  [319] 0.24067167 0.21891449 0.41762304 0.40766057 0.23181877 0.54456376
##  [325] 0.48695299 0.63382290 0.55626577 0.58139810 0.48532844 0.64467579
##  [331] 0.64316609 0.48509842 0.24084620 0.15776325 0.30205095 0.04490037
##  [337] 0.26373340 0.09140503 0.13980116 0.35511049 0.63452351 0.47248743
##  [343] 0.54078488 0.63342055 0.31262782 0.16577772 0.09452174 0.28997191
##  [349] 0.34750203 0.42469732 0.42298285 0.31062091 0.23244294 0.38043946
##  [355] 0.49733112 0.31964259 0.15050458 0.11721824 0.12253322 0.03283304
##  [361] 0.11043730 0.43945089 0.55288064 0.61698531 0.53129002 0.24975141
##  [367] 0.47471863 0.35282672 0.18868548 0.29400915 0.46269251 0.81813386
##  [373] 0.61401533 0.59716970 0.42326928 0.60579687 0.70943819 0.21528362
##  [379] 0.37189089 0.08025968 0.12878340 0.08763690 0.17232338 0.25656587
##  [385] 0.06131043 0.20329747 0.05071827 0.15625521 0.07916699 0.06567074
##  [391] 0.07307045 0.15265108 0.36000581 0.29640554 0.43949810 0.38065513
##  [397] 0.34450281 0.47626196 0.58117379 0.55897904 0.18908820 0.42013197
##  [403] 0.20531655 0.17449826 0.36077333 0.23212199 0.21513690 0.27758574
##  [409] 0.26294393 0.17843859 0.22629740 0.15714452 0.42570008 0.31835576
##  [415] 0.32261966 0.32081762 0.14470433 0.01716046 0.06262077 0.13029605
##  [421] 0.28861564 0.20238403 0.14834295 0.10929798 0.26623458 0.56387219
##  [427] 0.45339395 0.66119143 0.24316010 0.46520931 0.38612458 0.38784360
##  [433] 0.23892709 0.13254585 0.28261748 0.10203792 0.29758267 0.34082037
##  [439] 0.36988333 0.22623691 0.68732362 0.39100255 0.42506258 0.63090949
##  [445] 0.68396606 0.73387468 0.75421559 0.74680401 0.51603946 0.59139022
##  [451] 0.61495020 0.43336035 0.56406119 0.54682944 0.57398282 0.44475037
##  [457] 0.57270775 0.29087970 0.79738066 0.62882910 0.15397631 0.57443393
##  [463] 0.45499327 0.70180949 0.56894465 0.49747186 0.50790276 0.43740005
##  [469] 0.37225815 0.44209889 0.05510598 0.12011846 0.47789788 0.30657462
##  [475] 0.52260468 0.55299142 0.53401256 0.69214116 0.70922288 0.63732837
##  [481] 0.52976783 0.60404258 0.59961452 0.46111372 0.61904591 0.41428095
##  [487] 0.19610327 0.19939405 0.05903807 0.24282837 0.24477729 0.59016723
##  [493] 0.59782285 0.66658699 0.61526939 0.45935941 0.45304484 0.45557957
##  [499] 0.54431405 0.23244653 0.24632313 0.01676916 0.12506755 0.11022072
##  [505] 0.39140523 0.45839680 0.72641033 0.60683829 0.57712529 0.35950050
##  [511] 0.19520403 0.16595138 0.13609481 0.02186642 0.24901175 0.42641531
##  [517] 0.37394320 0.29451077 0.34117549 0.32091990 0.27250491 0.36823984
##  [523] 0.53711454 0.35931686 0.46235163 0.73167309 0.61966896 0.63250767
##  [529] 0.62056687 0.48436582 0.57880010 0.18070461 0.21795420 0.24567840
##  [535] 0.31105925 0.61902576 0.57652525 0.43803966 0.57925007 0.54815673
##  [541] 0.41437614 0.60002926 0.55246436 0.16878888 0.24296117 0.34436414
##  [547] 0.53399689 0.56269738 0.64384405 0.54353604 0.45028232 0.28819027
##  [553] 0.30300015 0.48609598 0.45446633 0.47041567 0.64770758 0.50288230
##  [559] 0.37639533 0.53945821 0.48919632 0.43238286 0.51862823 0.47716977
##  [565] 0.36770582 0.65086283 0.53924083 0.45003820 0.36998096 0.30004078
##  [571] 0.25427700 0.36179237 0.39607761 0.47419247 0.53291804 0.35017939
##  [577] 0.31996193 0.22498722 0.36965162 0.58999768 0.71486313 0.61448963
##  [583] 0.66400228 0.50588434 0.42723901 0.27866271 0.15190689 0.28378935
##  [589] 0.45212417 0.28884788 0.37788036 0.33633509 0.38490962 0.60032121
##  [595] 0.59328930 0.26111858 0.07967447 0.05465570 0.13753413 0.13987306
##  [601] 0.10686377 0.18399806 0.09369801 0.07816932 0.16336217 0.18425122
##  [607] 0.16519414 0.22197559 0.38830205 0.52240231 0.27835999 0.38540222
##  [613] 0.39968193 0.38258083 0.32096980 0.32080723 0.39111301 0.31563522
##  [619] 0.14851225 0.23868510 0.00693680 0.07803358 0.29881270 0.24662470
##  [625] 0.08489674 0.22486683 0.35980089 0.29477174 0.44165627 0.50123627
##  [631] 0.55695843 0.22515062 0.29789917 0.32449980 0.32595664 0.46596892
##  [637] 0.48937101 0.07732673 0.04696483 0.10799017 0.27396109 0.22805074
##  [643] 0.42346746 0.45341171 0.59885163 0.73539654 0.85412485 0.56414745
##  [649] 0.61899267 0.51379538 0.35799931 0.31938295 0.34094235 0.46157997
##  [655] 0.51069409 0.34171074 0.67443967 0.79776212 0.67645886 0.40554525
##  [661] 0.28358892 0.08021029 0.17570370 0.10207410 0.12220630 0.10847524
##  [667] 0.17427987 0.24620757 0.16333021 0.13686916 0.08702267 0.39361475
##  [673] 0.48535212 0.43494784 0.53204358 0.58227216 0.43119401 0.44860945
##  [679] 0.10635777 0.20607151 0.16857071 0.08377594 0.03846133 0.08639325
##  [685] 0.34830873 0.86088041 0.56541696 0.56701435 0.40106461 0.63288896
##  [691] 0.24934624 0.38078596 0.39081653 0.62712248 0.55621778 0.49402383
##  [697] 0.40183303 0.47411292 0.30402073 0.25149393 0.09856173 0.20100595
##  [703] 0.21208328 0.28181521 0.34424843 0.36374782 0.51105967 0.65655050
##  [709] 0.44589937 0.53202245 0.51621164 0.48167603 0.70480841 0.63549872
##  [715] 0.58154559 0.63973452 0.75155626 0.88245313 0.55114267 0.43296210
##  [721] 0.21159165 0.22364758 0.38221074 0.42452711 0.08476173 0.11331444
##  [727] 0.18271761 0.19049840 0.35525135 0.43340284 0.35676413 0.54565729
##  [733] 0.29035148 0.57848969 0.57735686 0.51735084 0.81148845 0.51678888
##  [739] 0.42566653 0.26861497 0.42733703 0.46654035 0.37875102 0.31083694
##  [745] 0.29412586 0.22889228 0.13044224 0.29719823 0.15257480 0.19208986
##  [751] 0.39431744 0.10083809 0.19017251 0.22588048 0.14234064 0.24704523
##  [757] 0.16732921 0.28379736 0.08137284 0.02530313 0.10277171 0.13184667
##  [763] 0.29468803 0.20599101 0.44984751 0.37952798 0.56315483 0.67687731
##  [769] 0.68141818 0.68842056 0.44107722 0.45350813 0.33674536 0.19276451
##  [775] 0.28333358 0.38277980 0.44547409 0.66630274 0.35600057 0.41792669
##  [781] 0.62921699 0.41712753 0.40116865 0.57137274 0.36053448 0.22311390
##  [787] 0.20602855 0.35573666 0.25749980 0.44496711 0.39019297 0.14549881
##  [793] 0.25722804 0.25185853 0.01648835 0.23433996 0.53884526 0.49051631
##  [799] 0.52124102 0.59062107 0.77819348 0.55092029 0.64169198 0.41069886
##  [805] 0.38444045 0.40432485 0.18157006 0.36132194 0.39994492 0.68141203
##  [811] 0.42679634 0.21001533 0.18951220 0.19007626 0.17815055 0.49284505
##  [817] 0.36275851 0.14558667 0.22279907 0.18450888 0.28831101 0.33513845
##  [823] 0.31790148 0.10354870 0.03338277 0.30477075 0.30367435 0.69290423
##  [829] 0.64651890 0.79126056 0.77729294 0.51113662 0.35239458 0.62699568
##  [835] 0.60051255 0.45035309 0.46011002 0.82221891 0.41891772 0.13478916
##  [841] 0.48380531 0.54485491 0.47056967 0.27579282 0.03430100 0.14139738
##  [847] 0.04101683 0.11777292 0.42579716 0.38603686 0.39781979 0.38288135
##  [853] 0.14393322 0.17176479 0.44272901 0.26767660 0.50003337 0.55015023
##  [859] 0.46681115 0.56962279 0.38483578 0.28605266 0.30388795 0.49075549
##  [865] 0.39512664 0.60828458 0.70452441 0.64051092 0.29756268 0.29145536
##  [871] 0.30292917 0.53663772 0.39455165 0.62236291 0.43886687 0.54404957
##  [877] 0.61921632 0.31536341 0.32760359 0.58064506 0.58359731 0.72460645
##  [883] 0.47551745 0.16474277 0.01274645 0.30348609 0.18394230 0.33958712
##  [889] 0.31185167 0.17393365 0.12702287 0.10553619 0.19579717 0.42192262
##  [895] 0.46369666 0.63717087 0.54189994 0.32908849 0.51539261 0.47922257
##  [901] 0.57517408 0.27475539 0.52896283 0.69089514 0.63152641 0.57641208
##  [907] 0.57534432 0.85143703 0.62053641 0.74364049 0.42833413 0.50847105
##  [913] 0.38394404 0.66077074 0.53489065 0.13539510 0.30645676 0.11343466
##  [919] 0.35070303 0.35924866 0.17422876 0.39498558 0.49800708 0.61621793
##  [925] 0.49421659 0.53560033 0.29199364 0.32449697 0.51146351 0.32766926
##  [931] 0.11143670 0.24230197 0.17245462 0.09190094 0.22950331 0.30657142
##  [937] 0.36763219 0.16364809 0.34899748 0.18281293 0.22700099 0.39973789
##  [943] 0.59013326 0.51002389 0.68831795 0.79710518 0.64330804 0.55788603
##  [949] 0.37394532 0.56882613 0.57513079 0.22278228 0.19087134 0.36413573
##  [955] 0.25859046 0.37505502 0.18663942 0.34783832 0.54570755 0.30486763
##  [961] 0.32662797 0.28983909 0.27177077 0.30717859 0.69983392 0.64677041
##  [967] 0.69903990 0.53471266 0.63423794 0.81173710 0.76211478 0.44799513
##  [973] 0.36271375 0.22201540 0.22743310 0.23696207 0.39748743 0.21992529
##  [979] 0.06979118 0.03697981 0.21587193 0.24728685 0.29524481 0.40509585
##  [985] 0.40810703 0.41534106 0.27306414 0.31129551 0.30489012 0.55279898
##  [991] 0.27509438 0.20579031 0.33443972 0.33047800 0.18681523 0.27727111
##  [997] 0.49549790 0.51416282 0.57626535 0.43717400</code></pre>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" tabindex="-1"></a><span class="do">## 比较</span></span>
<span id="cb140-2"><a href="#cb140-2" tabindex="-1"></a>compare<span class="ot">&lt;-</span><span class="fu">microbenchmark</span>(</span>
<span id="cb140-3"><a href="#cb140-3" tabindex="-1"></a>    <span class="at">Rcpp_function =</span> <span class="fu">Gibbs</span>(n, a, b, n_samples),</span>
<span id="cb140-4"><a href="#cb140-4" tabindex="-1"></a>    <span class="at">R_function =</span> <span class="fu">Gibbs_R</span>(n, a, b, n_samples)</span>
<span id="cb140-5"><a href="#cb140-5" tabindex="-1"></a>) </span>
<span id="cb140-6"><a href="#cb140-6" tabindex="-1"></a>  <span class="fu">summary</span>(compare)</span></code></pre></div>
<pre><code>##            expr    min     lq     mean  median      uq    max neval cld
## 1 Rcpp_function    4.8    6.1   15.918   12.15   24.75  107.1   100  a 
## 2    R_function 3206.3 3395.7 4060.068 3607.60 3896.80 8394.3   100   b</code></pre>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" tabindex="-1"></a>  <span class="do">##可以看出Cppfunction时间更短</span></span></code></pre></div>
<p>课堂作业</p>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb143-2"><a href="#cb143-2" tabindex="-1"></a>d1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">2.961</span>, <span class="fl">0.478</span>, <span class="sc">-</span><span class="fl">0.391</span>, <span class="sc">-</span><span class="fl">0.869</span>, <span class="sc">-</span><span class="fl">0.460</span>, </span>
<span id="cb143-3"><a href="#cb143-3" tabindex="-1"></a>            <span class="sc">-</span><span class="fl">0.937</span>, <span class="fl">0.779</span>, <span class="sc">-</span><span class="fl">1.409</span>, <span class="fl">0.027</span>, <span class="sc">-</span><span class="fl">1.569</span>);</span>
<span id="cb143-4"><a href="#cb143-4" tabindex="-1"></a>d2  <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">1.608</span>, <span class="fl">1.009</span>,  <span class="fl">0.878</span>,  <span class="fl">1.600</span>, <span class="sc">-</span><span class="fl">0.263</span>,  </span>
<span id="cb143-5"><a href="#cb143-5" tabindex="-1"></a>             <span class="fl">0.680</span>, <span class="fl">2.280</span>,  <span class="fl">2.390</span>, <span class="fl">1.793</span>,  <span class="fl">8.091</span>, <span class="fl">1.468</span>)</span>
<span id="cb143-6"><a href="#cb143-6" tabindex="-1"></a>bootstrap<span class="ot">&lt;-</span> <span class="cf">function</span>(sample1, sample2, R) {</span>
<span id="cb143-7"><a href="#cb143-7" tabindex="-1"></a>  n1 <span class="ot">&lt;-</span> <span class="fu">length</span>(sample1)</span>
<span id="cb143-8"><a href="#cb143-8" tabindex="-1"></a>  n2 <span class="ot">&lt;-</span> <span class="fu">length</span>(sample2)</span>
<span id="cb143-9"><a href="#cb143-9" tabindex="-1"></a>  mean_diff <span class="ot">&lt;-</span> <span class="fu">numeric</span>(R)</span>
<span id="cb143-10"><a href="#cb143-10" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>R) {</span>
<span id="cb143-11"><a href="#cb143-11" tabindex="-1"></a>    re1 <span class="ot">&lt;-</span> <span class="fu">sample</span>(sample1, n1, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb143-12"><a href="#cb143-12" tabindex="-1"></a>    re2 <span class="ot">&lt;-</span> <span class="fu">sample</span>(sample2, n2, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb143-13"><a href="#cb143-13" tabindex="-1"></a>    mean_diff[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(re1) <span class="sc">-</span> <span class="fu">mean</span>(re2)</span>
<span id="cb143-14"><a href="#cb143-14" tabindex="-1"></a>  }</span>
<span id="cb143-15"><a href="#cb143-15" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">sd</span>(mean_diff))</span>
<span id="cb143-16"><a href="#cb143-16" tabindex="-1"></a>}</span>
<span id="cb143-17"><a href="#cb143-17" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">bootstrap</span>(d1, d2, <span class="at">R =</span> <span class="dv">10000</span>)</span>
<span id="cb143-18"><a href="#cb143-18" tabindex="-1"></a><span class="fu">print</span>(result)</span></code></pre></div>
<pre><code>## [1] 0.7072093</code></pre>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
